(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29368,        640]
NotebookOptionsPosition[     26834,        591]
NotebookOutlinePosition[     27439,        613]
CellTagsIndexPosition[     27396,        610]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Initialization", "Subsection",
 CellChangeTimes->{{3.743129392799975*^9, 
  3.7431294010429983`*^9}},ExpressionUUID->"7ffb15db-563a-4366-9671-\
a836765c6757"],

Cell[CellGroupData[{

Cell["Palette Defs", "Section",
 CellChangeTimes->{{3.7433187422955585`*^9, 
  3.7433187552474194`*^9}},ExpressionUUID->"7c6636f2-ab23-4cc5-a29d-\
a1cc7d4fa932"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CreatePalette", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Button", "[", 
      RowBox[{"\"\<New Package\>\"", ",", "\[IndentingNewLine]", " ", 
       RowBox[{"Catch", "@", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "theName", ",", "name", ",", "document", ",", "directory", ",", 
            "nb"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"theName", "=", 
            RowBox[{"InputString", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"name", "=", 
            RowBox[{"StringReplace", "[", 
             RowBox[{"theName", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Except", "[", "WordCharacter", "]"}], "\[Rule]", 
                "\"\<\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"name", "===", "\"\<\>\""}], ",", 
             RowBox[{"Throw", "[", "$Failed", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"document", "=", "\[IndentingNewLine]", 
            RowBox[{"DocumentNotebook", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"TextCell", "[", 
                   RowBox[{"#", ",", "\"\<Title\>\"", ",", 
                    RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}], 
                  "&"}], "[", 
                 RowBox[{"name", "<>", "\"\<.m package\>\""}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"TextCell", "[", 
                 RowBox[{
                 "\"\<Begin the package\>\"", ",", "\"\<Section\>\""}], "]"}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ExpressionCell", "[", 
                   RowBox[{
                    RowBox[{"Defer", "[", 
                    RowBox[{"BeginPackage", "[", "#", "]"}], "]"}], ",", 
                    "\"\<Input\>\""}], "]"}], "&"}], "[", 
                 RowBox[{"name", "<>", "\"\<`\>\""}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"TextCell", "[", 
                 RowBox[{
                 "\"\<Usage messages for the public functions\>\"", ",", 
                  "\"\<Subsection\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ExpressionCell", "[", 
                 RowBox[{
                  RowBox[{"Defer", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MyFunction", "::", "usage"}], "=", 
                    "\"\<MyFunction[x] is a function that does \
something.\>\""}], ";"}], "]"}], ",", "\"\<Input\>\""}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"TextCell", "[", 
                 RowBox[{
                 "\"\<Begin the `Private context\>\"", ",", 
                  "\"\<Section\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ExpressionCell", "[", 
                 RowBox[{
                  RowBox[{"Defer", "[", 
                   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "]"}], 
                  ",", "\"\<Input\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"TextCell", "[", 
                 RowBox[{
                 "\"\<Function definitions\>\"", ",", "\"\<Subsection\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ExpressionCell", "[", 
                 RowBox[{
                  RowBox[{"Defer", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MyFunction", "[", "x", "]"}], ":=", "x"}], ";"}],
                    "]"}], ",", "\"\<Input\>\""}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"TextCell", "[", 
                 RowBox[{
                 "\"\<End the `Private context\>\"", ",", "\"\<Section\>\""}],
                  "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ExpressionCell", "[", 
                 RowBox[{
                  RowBox[{"Defer", "[", 
                   RowBox[{"End", "[", "]"}], "]"}], ",", "\"\<Input\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"TextCell", "[", 
                 RowBox[{
                 "\"\<End the package context\>\"", ",", "\"\<Section\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ExpressionCell", "[", 
                 RowBox[{
                  RowBox[{"Defer", "[", 
                   RowBox[{"EndPackage", "[", "]"}], "]"}], ",", 
                  "\"\<Input\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"StyleDefinitions", "\[Rule]", 
               RowBox[{"Notebook", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Cell", "[", 
                    RowBox[{"StyleData", "[", 
                    RowBox[{
                    "StyleDefinitions", "\[Rule]", "\"\<Default.nb\>\""}], 
                    "]"}], "]"}], ",", 
                   RowBox[{"Cell", "[", 
                    RowBox[{
                    RowBox[{"StyleData", "[", "\"\<Code\>\"", "]"}], ",", 
                    RowBox[{"PageWidth", "\[Rule]", "WindowWidth"}], ",", 
                    RowBox[{"AutoIndent", "\[Rule]", "Automatic"}], ",", 
                    RowBox[{"AutoSpacing", "\[Rule]", "True"}], ",", 
                    RowBox[{"LineBreakWithin", "\[Rule]", "Automatic"}], ",", 
                    RowBox[{"LineIndent", "\[Rule]", "1"}], ",", 
                    RowBox[{"LinebreakAdjustments", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.85", ",", "2", ",", "10", ",", "0", ",", "1"}],
                     "}"}]}]}], "]"}], ",", 
                   RowBox[{"Cell", "[", 
                    RowBox[{
                    RowBox[{"StyleData", "[", "\"\<Input\>\"", "]"}], ",", 
                    RowBox[{"InitializationCell", "\[Rule]", "True"}]}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{"Visible", "\[Rule]", "False"}], ",", 
                 RowBox[{
                 "StyleDefinitions", "\[Rule]", 
                  "\"\<PrivateStylesheetFormatting.nb\>\""}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"nb", "=", 
            RowBox[{"CreateWindow", "[", "document", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"directory", "=", 
            RowBox[{"SystemDialogInput", "[", "\"\<Directory\>\"", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"directory", "===", "$Canceled"}], ",", 
             RowBox[{"Throw", "[", "$Canceled", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"NotebookSave", "[", 
            RowBox[{"nb", ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"directory", ",", 
                RowBox[{"name", "<>", "\"\<.nb\>\""}]}], "}"}], "]"}]}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"12", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", "Bold",
           ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"WindowTitle", "\[Rule]", "\"\<New Package\>\""}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7433187577913814`*^9, 
  3.743318778885154*^9}},ExpressionUUID->"aa395a04-cbe5-421b-946e-\
3b9705bc42aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Palette work", "Section",
 CellChangeTimes->{{3.743318982987432*^9, 3.743318991603479*^9}, {
  3.7433190278642006`*^9, 
  3.7433190362161107`*^9}},ExpressionUUID->"8dd449b7-d98c-4362-a681-\
1e42cd06bccc"],

Cell[BoxData[
 RowBox[{"CreateMathematicaFileFromTemplate", "[", "templateFileName_String", 
  "]"}]], "Input",
 CellChangeTimes->{{3.743125259986281*^9, 3.7431253232186213`*^9}, {
  3.7431253582541943`*^9, 3.743125410141624*^9}, {3.743318176513998*^9, 
  3.7433181783650293`*^9}, {3.7433182514689755`*^9, 3.7433182605838757`*^9}, {
  3.743318294336512*^9, 3.743318311831375*^9}, {3.743318406708297*^9, 
  3.7433184375854607`*^9}, {3.743318493718853*^9, 3.7433184953758354`*^9}, {
  3.743318599228819*^9, 3.743318601660793*^9}, {3.743319569328656*^9, 
  3.743319569556654*^9}},ExpressionUUID->"171e76a4-4fcb-4b2b-b1d1-\
306483ca1209"],

Cell[BoxData[
 RowBox[{"d1", "=", 
  RowBox[{
  "Definition", "[", "extractNotebookTemplateParameters", "]"}]}]], "Input",
 CellChangeTimes->{{3.743125513123612*^9, 3.74312565351519*^9}},
 CellLabel->
  "In[372]:=",ExpressionUUID->"20c2911a-fb5a-4153-a15c-350cf74aeab0"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "f", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "f", "]"}], "=", 
  RowBox[{"<|", 
   RowBox[{"o1", "\[Rule]", "1"}], "|>"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"a_", ",", "b_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"o1", "\[Rule]", "1"}], ",", 
        RowBox[{"o2", "\[Rule]", "2"}], ",", 
        RowBox[{"o3", "\[RuleDelayed]", " ", "3"}]}], "}"}], "]"}]}]}], "]"}],
   ":=", 
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", " ", 
    RowBox[{"OptionValue", "[", "o1", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DownValues", "[", "extractNotebookTemplateParameters", "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1", ",", "1", ",", "All", ",", "1"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DownValues", "[", "f", "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1", ",", "1", ",", "All", ",", "1"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"f", "[", 
  RowBox[{"1", ",", "2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.743125656496145*^9, 3.7431259881781783`*^9}, {
   3.743126021351875*^9, 3.7431260902250814`*^9}, {3.7431261394102488`*^9, 
   3.743126149316156*^9}, {3.7431265747978897`*^9, 3.7431266577982874`*^9}, {
   3.743126839755212*^9, 3.7431268734919195`*^9}, {3.74312726049397*^9, 
   3.743127264738925*^9}, {3.7431387616214085`*^9, 3.743138776473198*^9}, {
   3.7431389274314175`*^9, 3.7431389388162436`*^9}, {3.743139914976277*^9, 
   3.743139962502906*^9}, {3.743140360760974*^9, 3.7431403644039345`*^9}, 
   3.7431405415076723`*^9, {3.743140615437667*^9, 
   3.743140617360673*^9}},ExpressionUUID->"03385c72-4d55-410f-b6c8-\
d10c20c5e462"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "f1", "]"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f1", "[", "a_", "]"}], "[", 
   RowBox[{"b_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"o1", "\[Rule]", "1"}], ",", 
        RowBox[{"o2", "\[Rule]", "2"}], ",", 
        RowBox[{"o3", "\[RuleDelayed]", " ", "3"}]}], "}"}], "]"}]}]}], "]"}],
   ":=", 
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", 
    RowBox[{"Options", "[", "f", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f1", "[", "1", "]"}], "[", "2", "]"}], "  "}]}], "Input",
 CellChangeTimes->{{3.7431271835871625`*^9, 3.743127231355612*^9}, {
   3.743127611461894*^9, 3.7431276572133493`*^9}, {3.7431282019385815`*^9, 
   3.743128215946915*^9}, 3.7431283388649826`*^9, {3.7431409617889504`*^9, 
   3.743140967497877*^9}, {3.743319390059512*^9, 
   3.7433194103630533`*^9}},ExpressionUUID->"fac18191-5ebe-4c64-ae4c-\
bb1ae3b43728"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"nbo1", "=", 
  RowBox[{"NotebookTemplate", "[", 
   RowBox[{"RelativeFilePath", "[", 
    RowBox[{"$$TemplateWorkingDirectory", ",", "\"\<Test-Template.nb\>\""}], 
    "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nbo2", " ", "=", " ", 
  RowBox[{"TemplateApply", "[", 
   RowBox[{"nbo1", ",", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{
      "\"\<string1\>\"", " ", "\[Rule]", " ", "\"\<inputString1\>\""}], ",", 
      RowBox[{"\"\<int1\>\"", " ", "\[Rule]", " ", "11"}], ",", 
      RowBox[{
      "\"\<string2\>\"", " ", "\[Rule]", " ", "\"\<inputString2\>\""}], ",", 
      RowBox[{"\"\<int2\>\"", " ", "\[Rule]", " ", "22"}], ",", 
      RowBox[{"\"\<1\>\"", "\[Rule]", " ", "\"\<inputString3\>\""}], ",", 
      RowBox[{"\"\<2\>\"", "\[Rule]", " ", "13"}]}], "|>"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nb1", "=", 
  RowBox[{"NotebookGet", "@@", "nbo1", " "}]}]}], "Input",
 CellChangeTimes->{{3.7431143898127184`*^9, 3.74311441935818*^9}, {
   3.7431146139275784`*^9, 3.7431146412523346`*^9}, {3.743114907997929*^9, 
   3.7431149227207713`*^9}, {3.7431149545463986`*^9, 3.743114960802272*^9}, {
   3.743115007558297*^9, 3.743115059578559*^9}, {3.743115151139092*^9, 
   3.7431151547300296`*^9}, 3.7431151968785543`*^9, {3.743117524980957*^9, 
   3.743117550844653*^9}, {3.7431176137930493`*^9, 3.743117723020121*^9}, {
   3.743117761860484*^9, 3.7431178067060003`*^9}, {3.7431178628330173`*^9, 
   3.743117908053575*^9}, {3.7431179565161195`*^9, 3.7431179831764135`*^9}, {
   3.7431180564615035`*^9, 3.7431180766982327`*^9}, {3.743118130230661*^9, 
   3.7431181345706053`*^9}, {3.7431182320054607`*^9, 
   3.7431182742049193`*^9}, {3.743118694718297*^9, 3.7431186963752785`*^9}, {
   3.743118889884525*^9, 3.7431188905323772`*^9}, {3.7431191743654375`*^9, 
   3.7431191894813147`*^9}, {3.7431192899234753`*^9, 3.743119346491938*^9}, {
   3.7431193810311737`*^9, 3.7431194327904425`*^9}, {3.743119500528703*^9, 
   3.7431195231575055`*^9}, {3.7431195836374655`*^9, 
   3.7431196112401733`*^9}, {3.7431196577232018`*^9, 
   3.7431196586431384`*^9}, {3.743124240791254*^9, 3.743124243592205*^9}, 
   3.743125141159222*^9, 3.7433191286978865`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"c4836a6d-2fb0-4105-be8b-f06f463876b1"],

Cell[BoxData[
 RowBox[{"TemplateObject", "[", 
  TemplateBox[{FrontEndObject[
     LinkObject["xwt4x_shm", 3, 1]],260,
    "FrontEndObject[LinkObject[\"xwt4x_shm\", 3, 1]]","260",
    "\"Test-Template.nb\"",
    "\"E:\\\\Mathematica\\\\Templates\\\\Test-Template.nb\""},
   "NotebookObject"], "]"}]], "Output",
 CellChangeTimes->{3.74331913314567*^9, 3.7433192316022143`*^9, 
  3.7433192643757744`*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"825506dd-b989-4834-8ac8-979172f7b8f2"],

Cell[BoxData[
 TemplateBox[{FrontEndObject[
    LinkObject["xwt4x_shm", 3, 1]],262,
   "FrontEndObject[LinkObject[\"xwt4x_shm\", 3, 1]]","262","\"Untitled-8\""},
  "NotebookObjectUnsaved"]], "Output",
 CellChangeTimes->{3.74331913314567*^9, 3.7433192316022143`*^9, 
  3.743319265144757*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"3245929b-9ef9-417e-9043-8f6c5463fc24"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SetOptions", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Visible", "\[Rule]", "True"}]}], "]"}], ";", 
     RowBox[{"NotebookSave", "[", 
      RowBox[{"#", ",", 
       RowBox[{"RelativeFilePath", "[", "\"\<testp1.nb\>\"", "]"}]}], "]"}]}],
     ")"}], "&"}], "[", "nbo2", "]"}]], "Input",
 CellChangeTimes->{{3.743124255094491*^9, 3.743124263747391*^9}, {
  3.7431243984978323`*^9, 3.743124442081756*^9}, {3.7431245749462833`*^9, 
  3.743124596862047*^9}, {3.7431246600903034`*^9, 3.7431246631873302`*^9}, {
  3.743124736277667*^9, 3.743124767565051*^9}, {3.7431248240229187`*^9, 
  3.743124839399702*^9}, {3.7431249686750298`*^9, 3.74312497373096*^9}, {
  3.7431251089579544`*^9, 
  3.7431251502724133`*^9}},ExpressionUUID->"517a7239-6de5-4548-8cc3-\
ffa85da6c14f"],

Cell[BoxData["PWD"], "Input",
 CellChangeTimes->{{3.743406196048397*^9, 
  3.7434062033924522`*^9}},ExpressionUUID->"23032859-04cc-4ff9-ab47-\
063d6f684ebf"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "$DefaultTemplateDirectory", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$DefaultTemplateDirectory", "=", " ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<ManagedTemplates\>\""}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.743406114599327*^9, 3.743406194272724*^9}, {
  3.743408352104004*^9, 3.743408437535899*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"a521d1de-257a-4e15-ad5d-4a474a03b1d0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "extractNotebookTemplateParameters", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"retrieveTemplateNotebooks", "[", 
   RowBox[{"dirs__:", "$DefaultTemplateDirectory"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"KeyMap", "[", "FileBaseName", "]"}], " ", "@", " ", 
   RowBox[{"AssociationMap", "[", 
    RowBox[{"NotebookTemplate", ",", " ", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*.nb\>\"", ",", "dirs"}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extractNotebookTemplateParameters", "[", 
    RowBox[{"nb_Notebook:", 
     RowBox[{"NotebookGet", "@@", 
      RowBox[{
       RowBox[{"First", "@*", "Values"}], "@", 
       RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{"#1", "\[Rule]", " ", "#2"}], "|>"}], "&"}], "@@@", 
    RowBox[{"Sort", "@", 
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"nb", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"TemplateBox", "[", 
         RowBox[{"param_List", ",", " ", "\"\<NotebookTemplateSlot\>\""}], 
         "]"}], " ", "\[RuleDelayed]", "  ", "param"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createNotebook", "[", 
   RowBox[{"templateNb_TemplateObject", ",", " ", "args_List"}], "]"}], 
  ":="}]}], "Input",
 CellChangeTimes->{{3.7431143898127184`*^9, 3.74311441935818*^9}, {
   3.7431146139275784`*^9, 3.7431146412523346`*^9}, {3.743114907997929*^9, 
   3.7431149227207713`*^9}, {3.7431149545463986`*^9, 3.743114960802272*^9}, {
   3.743115007558297*^9, 3.743115059578559*^9}, {3.743115151139092*^9, 
   3.7431151547300296`*^9}, 3.7431151968785543`*^9, {3.743117524980957*^9, 
   3.743117550844653*^9}, {3.7431176137930493`*^9, 3.743117723020121*^9}, {
   3.743117761860484*^9, 3.7431178067060003`*^9}, {3.7431178628330173`*^9, 
   3.743117908053575*^9}, {3.7431179565161195`*^9, 3.7431179831764135`*^9}, {
   3.7431180564615035`*^9, 3.7431180766982327`*^9}, {3.743118130230661*^9, 
   3.7431181345706053`*^9}, {3.7431182320054607`*^9, 
   3.7431182742049193`*^9}, {3.743118694718297*^9, 3.7431186963752785`*^9}, {
   3.743118889884525*^9, 3.7431188905323772`*^9}, {3.7431191743654375`*^9, 
   3.7431191894813147`*^9}, {3.7431192899234753`*^9, 3.743119346491938*^9}, {
   3.7431193810311737`*^9, 3.7431194327904425`*^9}, {3.743119500528703*^9, 
   3.7431195035247216`*^9}, {3.743119595225401*^9, 3.7431196001952944`*^9}, {
   3.7431196732310777`*^9, 3.743119700786317*^9}, {3.743119893294739*^9, 
   3.7431199185402946`*^9}, {3.743120023650436*^9, 3.7431200523431673`*^9}, 
   3.7431201508568544`*^9, {3.743120248533351*^9, 3.743120271371417*^9}, {
   3.743120323592951*^9, 3.7431203309748254`*^9}, {3.7431203863079967`*^9, 
   3.743120512085533*^9}, 3.7431207409200487`*^9, {3.7431208483628187`*^9, 
   3.74312085036481*^9}, {3.7431209722358227`*^9, 3.7431209874073963`*^9}, {
   3.7431212770319633`*^9, 3.7431213911229305`*^9}, {3.743121421252657*^9, 
   3.7431214238655696`*^9}, {3.743121574686657*^9, 3.743121578786496*^9}, 
   3.743121644742256*^9, {3.7431217113455286`*^9, 3.7431217418121433`*^9}, {
   3.743121988743255*^9, 3.7431219968865414`*^9}, {3.7431220580889797`*^9, 
   3.7431220608339653`*^9}, {3.7431220942784033`*^9, 3.743122105982277*^9}, 
   3.743122578240077*^9, {3.7431226410493145`*^9, 3.743122646451257*^9}, {
   3.743122683110828*^9, 3.7431227216236053`*^9}, {3.743122759919928*^9, 
   3.7431229394821377`*^9}, {3.7431229790507674`*^9, 3.743122996780219*^9}, {
   3.743123030496857*^9, 3.7431230332258277`*^9}, {3.7431232469307613`*^9, 
   3.743123247415704*^9}, {3.7431233517857056`*^9, 3.743123408297557*^9}, {
   3.7431234690439587`*^9, 3.7431234718419385`*^9}, {3.743123544208542*^9, 
   3.743123586981084*^9}, {3.7431236511937304`*^9, 3.743123684573372*^9}, {
   3.743123785039321*^9, 3.7431240050996857`*^9}, {3.7431240672922955`*^9, 
   3.743124071583309*^9}, {3.7431250804429445`*^9, 3.743125107123953*^9}, 
   3.743125161969286*^9, {3.743319901500681*^9, 3.7433199037048073`*^9}, {
   3.743405391053672*^9, 3.743405391629106*^9}, 3.7434054286676807`*^9, {
   3.7434058035390463`*^9, 3.743405805425516*^9}, {3.743405861896476*^9, 
   3.743405867717947*^9}, {3.743405998167721*^9, 3.743405999263789*^9}, {
   3.743406031849875*^9, 3.7434060400487423`*^9}, {3.743406071459153*^9, 
   3.7434061120668488`*^9}, 3.743409101008787*^9, {3.743409149430593*^9, 
   3.743409261727395*^9}, {3.743409562586545*^9, 3.7434096175225277`*^9}, {
   3.743409675058773*^9, 3.743409675502289*^9}, 3.743409772527549*^9, 
   3.743409873633379*^9, {3.743409909553877*^9, 3.743409976799683*^9}, {
   3.7434101132589693`*^9, 3.7434101561400633`*^9}, {3.74341018829559*^9, 
   3.743410189344109*^9}, {3.743410760659079*^9, 3.743410779095319*^9}, 
   3.74341082044566*^9, 3.743410874127739*^9, {3.743410915773912*^9, 
   3.7434109202929583`*^9}, {3.7434113144627*^9, 
   3.7434113149459267`*^9}},ExpressionUUID->"349643d3-6e21-402b-ae8a-\
4d7d4a08ce82"],

Cell[BoxData[
 RowBox[{"createNotebook", "[", 
  RowBox[{"templateNb_TemplateObject", ",", "args_List"}], "]"}]], "Output",
 CellChangeTimes->{
  3.743410783441628*^9, {3.743410875270569*^9, 3.743410879746587*^9}, 
   3.7434109219286957`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"a1971ea3-4677-4f19-8086-f4d49304fd3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"retrieveTemplateNotebooks", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"extractNotebookTemplateParameters", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.743409275334981*^9, 3.7434092781701727`*^9}, {
   3.7434102593013287`*^9, 3.743410284984929*^9}, {3.7434103403825607`*^9, 
   3.743410351305915*^9}, {3.743410483839911*^9, 3.7434105089452887`*^9}, {
   3.7434106047015247`*^9, 3.743410639865567*^9}, {3.743410824138483*^9, 
   3.7434108648902407`*^9}, 3.743410912862914*^9, {3.7434110083863077`*^9, 
   3.743411012656252*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"0267ab6d-8ecb-4718-85c2-db067d61922e"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"\<\"Test-Template\"\>", "\[Rule]", 
   RowBox[{"TemplateObject", "[", 
    TemplateBox[{FrontEndObject[
       LinkObject["6fr9r_shm", 3, 1]],34,
      "FrontEndObject[LinkObject[\"6fr9r_shm\", 3, 1]]","34",
      "\"Test-Template.nb\"",
      "\"/Users/thoughtworks/dev/projects/mathematica-misc/Palettes/\
ManagedTemplates/Test-Template.nb\""},
     "NotebookObject"], "]"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.743410260744255*^9, 3.743410286266135*^9}, {
   3.743410485324114*^9, 3.743410496240234*^9}, 3.743410608287479*^9, {
   3.7434108254930763`*^9, 3.7434108532429667`*^9}, 3.7434108859123487`*^9, 
   3.743410925612379*^9, 3.743411013249628*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"4504ea96-f98b-4f4a-b3f8-37bf1df7a654"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"\\\"1\\\"\"\>", "\[Rule]", "\<\"1\"\>"}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"\\\"2\\\"\"\>", "\[Rule]", "\<\"2\"\>"}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"\\\"int1\\\"\"\>", "\[Rule]", "\<\"1\"\>"}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"\\\"int2\\\"\"\>", "\[Rule]", "\<\"2\"\>"}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"\\\"string1\\\"\"\>", 
     "\[Rule]", "\<\"\\\"stringD1\\\"\"\>"}], "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"\\\"string2\\\"\"\>", "\[Rule]", "\<\"\\\"string2\\\"\"\>"}],
     "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.743410260744255*^9, 3.743410286266135*^9}, {
   3.743410485324114*^9, 3.743410496240234*^9}, 3.743410608287479*^9, {
   3.7434108254930763`*^9, 3.7434108532429667`*^9}, 3.7434108859123487`*^9, 
   3.743410925612379*^9, 3.743411013264471*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"3663405e-bcac-47e2-9c5a-a32449edd175"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"createMathFileFromTemplateRequest", "[", "_template", "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.74332277668003*^9, 3.743322829718516*^9}, {
  3.743322868324092*^9, 
  3.743322894043793*^9}},ExpressionUUID->"a18561ba-94a3-4780-a1e1-\
c586208c99ec"]
}, Open  ]]
},
AutoGeneratedPackage->Manual,
WindowSize->{1440, 771},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "BStyle.nb"]]}, Visible -> False, 
  FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 164, 3, 56, "Subsection",ExpressionUUID->"7ffb15db-563a-4366-9671-a836765c6757"],
Cell[CellGroupData[{
Cell[747, 27, 161, 3, 53, "Section",ExpressionUUID->"7c6636f2-ab23-4cc5-a29d-a1cc7d4fa932"],
Cell[911, 32, 8663, 180, 1041, "Input",ExpressionUUID->"aa395a04-cbe5-421b-946e-3b9705bc42aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9611, 217, 210, 4, 67, "Section",ExpressionUUID->"8dd449b7-d98c-4362-a681-1e42cd06bccc"],
Cell[9824, 223, 634, 10, 32, "Input",ExpressionUUID->"171e76a4-4fcb-4b2b-b1d1-306483ca1209"],
Cell[10461, 235, 270, 6, 32, "Input",ExpressionUUID->"20c2911a-fb5a-4153-a15c-350cf74aeab0"],
Cell[10734, 243, 1797, 41, 138, "Input",ExpressionUUID->"03385c72-4d55-410f-b6c8-d10c20c5e462"],
Cell[12534, 286, 1031, 26, 75, "Input",ExpressionUUID->"fac18191-5ebe-4c64-ae4c-bb1ae3b43728"],
Cell[CellGroupData[{
Cell[13590, 316, 2277, 40, 75, "Input",ExpressionUUID->"c4836a6d-2fb0-4105-be8b-f06f463876b1"],
Cell[15870, 358, 480, 10, 45, "Output",ExpressionUUID->"825506dd-b989-4834-8ac8-979172f7b8f2"],
Cell[16353, 370, 368, 7, 45, "Output",ExpressionUUID->"3245929b-9ef9-417e-9043-8f6c5463fc24"]
}, Open  ]],
Cell[16736, 380, 850, 19, 32, "Input",ExpressionUUID->"517a7239-6de5-4548-8cc3-ffa85da6c14f"],
Cell[17589, 401, 157, 3, 32, "Input",ExpressionUUID->"23032859-04cc-4ff9-ab47-063d6f684ebf"],
Cell[17749, 406, 544, 12, 54, "Input",ExpressionUUID->"a521d1de-257a-4e15-ad5d-4a474a03b1d0"],
Cell[CellGroupData[{
Cell[18318, 422, 5162, 90, 138, "Input",ExpressionUUID->"349643d3-6e21-402b-ae8a-4d7d4a08ce82"],
Cell[23483, 514, 321, 6, 36, "Output",ExpressionUUID->"a1971ea3-4677-4f19-8086-f4d49304fd3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23841, 525, 634, 9, 54, "Input",ExpressionUUID->"0267ab6d-8ecb-4718-85c2-db067d61922e"],
Cell[24478, 536, 815, 15, 45, "Output",ExpressionUUID->"4504ea96-f98b-4f4a-b3f8-37bf1df7a654"],
Cell[25296, 553, 1218, 25, 39, "Output",ExpressionUUID->"3663405e-bcac-47e2-9c5a-a32449edd175"]
}, Open  ]],
Cell[26529, 581, 289, 7, 32, "Input",ExpressionUUID->"a18561ba-94a3-4780-a1e1-c586208c99ec"]
}, Open  ]]
}
]
*)

