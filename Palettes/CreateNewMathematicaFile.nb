(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     88573,       1910]
NotebookOptionsPosition[     85101,       1848]
NotebookOutlinePosition[     85734,       1871]
CellTagsIndexPosition[     85691,       1868]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Initialization", "Subsection",
 CellChangeTimes->{{3.743129392799975*^9, 
  3.7431294010429983`*^9}},ExpressionUUID->"7ffb15db-563a-4366-9671-\
a836765c6757"],

Cell[CellGroupData[{

Cell["Palette Defs", "Section",
 CellChangeTimes->{{3.7433187422955585`*^9, 
  3.7433187552474194`*^9}},ExpressionUUID->"7c6636f2-ab23-4cc5-a29d-\
a1cc7d4fa932"],

Cell[BoxData[
 RowBox[{"FrontEndExecute", " ", "Evaluate"}]], "Input",
 CellChangeTimes->{{3.7441745345206213`*^9, 
  3.744174544272182*^9}},ExpressionUUID->"01a0dcfc-d5bd-44f4-bafd-\
60b95e8c93bb"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"templates", "=", 
     RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"templateType", " ", "=", " ", "Null"}], ",", 
       RowBox[{"templateObject", " ", "=", " ", "Null"}], ",", "tForm"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"templateObject", " ", ":=", 
       RowBox[{"Lookup", "[", 
        RowBox[{"templates", ",", "templateType", ",", "Null"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"templateForm", "[", "Null", "]"}], ":=", "Null"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"templateForm", "[", "to_", "]"}], ":=", 
       RowBox[{"FormObject", "[", 
        RowBox[{"AutoSubmitting", "[", 
         RowBox[{"KeyValueMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "\[Rule]", " ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                RowBox[{"formTypeFromDefault", "[", "#2", "]"}]}], ",", " ", 
               RowBox[{"\"\<Default\>\"", "\[Rule]", "  ", "#2"}], ",", 
               RowBox[{"\"\<Input\>\"", "\[Rule]", "  ", "#2"}]}], "|>"}]}], 
            "&"}], ",", " ", 
           RowBox[{"extractNotebookTemplateParameters", "[", "to", "]"}]}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tForm", ":=", 
       RowBox[{"templateForm", "[", "templateObject", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PopupMenu", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "templateType", "]"}], ",", 
           RowBox[{"Keys", "[", "templates", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Dynamic", "@", "tForm"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"tForm", "[", "All", "]"}], "]"}]}], "}"}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7436906820931835`*^9, 3.7436908941113644`*^9}, {
   3.7436909433448443`*^9, 3.7436910218267765`*^9}, {3.743694309032935*^9, 
   3.7436943575023975`*^9}, {3.74369439143104*^9, 3.7436944063188825`*^9}, {
   3.7436946847436714`*^9, 3.7436946968393087`*^9}, {3.7436947615510707`*^9, 
   3.743694815141533*^9}, {3.743694880985838*^9, 3.7436949360323305`*^9}, 
   3.7436949737439747`*^9, {3.7436950628921766`*^9, 3.7436950757180505`*^9}, {
   3.7436951735830173`*^9, 3.7436952407728863`*^9}, {3.743695351341086*^9, 
   3.7436953661559305`*^9}, {3.743695441001273*^9, 3.7436954867415743`*^9}, 
   3.7436955345300694`*^9, {3.743695570015694*^9, 3.7436955706576896`*^9}, {
   3.7436960031689315`*^9, 3.7436960098329124`*^9}, {3.7436960524162955`*^9, 
   3.743696084039022*^9}, {3.7436962728309546`*^9, 3.7436962804138727`*^9}, {
   3.7436964789344716`*^9, 3.7436964937395086`*^9}, 3.7436966003974857`*^9, {
   3.7436968631838646`*^9, 3.7436969119904833`*^9}, {3.743697001336815*^9, 
   3.743697229415266*^9}, {3.7437020600001097`*^9, 3.743702111839523*^9}, {
   3.74370223146054*^9, 3.7437022736938515`*^9}, {3.7437023982473516`*^9, 
   3.743702452051268*^9}, {3.7437025162885046`*^9, 3.74370251660345*^9}, {
   3.743703326733633*^9, 3.74370333451739*^9}, {3.74370344112199*^9, 
   3.7437034852245245`*^9}, {3.7437036768154135`*^9, 
   3.7437036941781764`*^9}, {3.743703838494722*^9, 3.7437038430637264`*^9}, {
   3.743703900464131*^9, 3.7437039160550175`*^9}, {3.743704152006121*^9, 
   3.743704183324092*^9}, {3.743704228319758*^9, 3.7437042488433003`*^9}, {
   3.743704298584871*^9, 3.74370432608244*^9}, {3.7437044185684824`*^9, 
   3.7437044842550507`*^9}, {3.7437045283496513`*^9, 3.743704551404407*^9}, {
   3.74370458231802*^9, 3.7437045974608607`*^9}, {3.7437046352500525`*^9, 
   3.7437046664347363`*^9}, {3.7437047162085557`*^9, 
   3.7437047553172035`*^9}, {3.7437047856645536`*^9, 
   3.7437048100092964`*^9}, {3.7437048533861156`*^9, 3.743704873408097*^9}, {
   3.7437049673139973`*^9, 3.743704971307*^9}, {3.743705028550273*^9, 
   3.743705088261606*^9}, {3.743705134075382*^9, 3.7437051523327894`*^9}, {
   3.743705190125862*^9, 3.7437052097410746`*^9}, {3.743705281977318*^9, 
   3.74370528511528*^9}, {3.7437053298808513`*^9, 3.7437053583396015`*^9}, {
   3.7437072076196256`*^9, 3.7437072807268777`*^9}, {3.7437073774642134`*^9, 
   3.743707379099249*^9}, {3.743707426805698*^9, 3.7437074285106816`*^9}, {
   3.74370751211747*^9, 3.7437076091330423`*^9}, {3.743707645223984*^9, 
   3.7437076571509314`*^9}, {3.743707696084939*^9, 3.743707726771617*^9}, {
   3.743707804769553*^9, 3.743707834350297*^9}, {3.7437079625956583`*^9, 
   3.7437080097894115`*^9}, {3.743712404537057*^9, 3.743712411589941*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"38fa1908-f725-49be-9049-4be2f0f99151"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"templates", "=", 
     RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tt", " ", "=", " ", "Null"}], ",", 
       RowBox[{"to", " ", "=", " ", "Null"}], ",", "templateForm", ",", 
       "tForm", ",", 
       RowBox[{"tArgs", "=", "Null"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"templateForm", "[", "Null", "]"}], "=", "Nothing"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"templateForm", "[", "args_", "]"}], ":=", 
       RowBox[{"FormObject", "[", 
        RowBox[{"AutoSubmitting", "[", 
         RowBox[{"KeyValueMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "\[Rule]", " ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                RowBox[{"formTypeFromDefault", "[", "#2", "]"}]}], ",", " ", 
               RowBox[{"\"\<Default\>\"", "\[Rule]", "  ", "#2"}], ",", 
               RowBox[{"\"\<Input\>\"", "\[Rule]", "  ", "#2"}]}], "|>"}]}], 
            "&"}], ",", " ", "args"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PopupMenu", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{"tt", ",", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"tt", "=", "#"}], ";", 
                RowBox[{"to", "=", 
                 RowBox[{"Lookup", "[", 
                  RowBox[{"templates", ",", "tt", ",", "Null"}], "]"}]}], ";", 
                RowBox[{"tArgs", "=", 
                 RowBox[{
                 "extractNotebookTemplateParameters", "[", "to", "]"}]}], ";", 
                RowBox[{"tForm", "=", 
                 RowBox[{"templateForm", "[", "tArgs", "]"}]}]}], ")"}], 
              "&"}]}], "]"}], ",", 
           RowBox[{"Keys", "[", "templates", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Dynamic", "[", "tt", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Dynamic", "[", "to", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Dynamic", "[", "tArgs", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Dynamic", "[", "tForm", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"tForm", "[", 
           RowBox[{"All", ",", "\"\<Input\>\""}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"FormControl", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "tArgs", "]"}], ",", 
            RowBox[{"AutoSubmitting", "[", "tForm", "]"}]}], "]"}], "]"}]}], 
        "}"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7436906820931835`*^9, 3.7436908941113644`*^9}, {
   3.7436909433448443`*^9, 3.7436910218267765`*^9}, {3.743694309032935*^9, 
   3.7436943575023975`*^9}, {3.74369439143104*^9, 3.7436944063188825`*^9}, {
   3.7436946847436714`*^9, 3.7436946968393087`*^9}, {3.7436947615510707`*^9, 
   3.743694815141533*^9}, {3.743694880985838*^9, 3.7436949360323305`*^9}, 
   3.7436949737439747`*^9, {3.7436950628921766`*^9, 3.7436950757180505`*^9}, {
   3.7436951735830173`*^9, 3.7436952407728863`*^9}, {3.743695351341086*^9, 
   3.7436953661559305`*^9}, {3.743695441001273*^9, 3.7436954867415743`*^9}, 
   3.7436955345300694`*^9, {3.743695570015694*^9, 3.7436955706576896`*^9}, {
   3.7436960031689315`*^9, 3.7436960098329124`*^9}, {3.7436960524162955`*^9, 
   3.743696084039022*^9}, {3.7436962728309546`*^9, 3.7436962804138727`*^9}, {
   3.7436964789344716`*^9, 3.7436964937395086`*^9}, 3.7436966003974857`*^9, {
   3.7436968631838646`*^9, 3.7436969119904833`*^9}, {3.743697001336815*^9, 
   3.743697229415266*^9}, {3.7437020600001097`*^9, 3.743702111839523*^9}, {
   3.74370223146054*^9, 3.7437022736938515`*^9}, {3.7437023982473516`*^9, 
   3.743702452051268*^9}, {3.7437025162885046`*^9, 3.74370251660345*^9}, {
   3.743703326733633*^9, 3.74370333451739*^9}, {3.74370344112199*^9, 
   3.7437034852245245`*^9}, {3.7437036768154135`*^9, 
   3.7437036941781764`*^9}, {3.743703838494722*^9, 3.7437038430637264`*^9}, {
   3.743703900464131*^9, 3.7437039160550175`*^9}, {3.743704152006121*^9, 
   3.743704183324092*^9}, {3.743704228319758*^9, 3.7437042488433003`*^9}, {
   3.743704298584871*^9, 3.74370432608244*^9}, {3.7437044185684824`*^9, 
   3.7437044842550507`*^9}, {3.7437045283496513`*^9, 3.743704551404407*^9}, {
   3.74370458231802*^9, 3.7437045974608607`*^9}, {3.7437046352500525`*^9, 
   3.7437046664347363`*^9}, {3.7437047162085557`*^9, 
   3.7437047553172035`*^9}, {3.7437047856645536`*^9, 
   3.7437048100092964`*^9}, {3.7437048533861156`*^9, 3.743704873408097*^9}, {
   3.7437049673139973`*^9, 3.743704971307*^9}, {3.743705028550273*^9, 
   3.743705088261606*^9}, {3.743705134075382*^9, 3.7437051523327894`*^9}, {
   3.743705190125862*^9, 3.7437052097410746`*^9}, {3.743705281977318*^9, 
   3.74370528511528*^9}, {3.7437053298808513`*^9, 3.7437053583396015`*^9}, {
   3.7437072076196256`*^9, 3.7437072807268777`*^9}, {3.7437073774642134`*^9, 
   3.743707379099249*^9}, {3.743707426805698*^9, 3.7437074285106816`*^9}, {
   3.74370751211747*^9, 3.7437076091330423`*^9}, {3.743707645223984*^9, 
   3.7437076571509314`*^9}, {3.743707696084939*^9, 3.743707726771617*^9}, {
   3.743707804769553*^9, 3.743707834350297*^9}, {3.7437079625956583`*^9, 
   3.7437080097894115`*^9}, {3.7437081874944987`*^9, 
   3.7437083897556133`*^9}, {3.743708445174043*^9, 3.743708464254833*^9}, {
   3.7437085671161723`*^9, 3.743708587134912*^9}, {3.7437090591535454`*^9, 
   3.7437090688124433`*^9}, {3.743709164326188*^9, 3.7437093262295556`*^9}, {
   3.743709385275774*^9, 3.7437094063896036`*^9}, {3.7437096070786963`*^9, 
   3.7437096425712795`*^9}, {3.7437096760409603`*^9, 3.743709701594425*^9}, {
   3.743709764845928*^9, 3.743709793368337*^9}, {3.743709996113002*^9, 
   3.7437100580352964`*^9}, {3.743710105383926*^9, 3.7437101741885657`*^9}, {
   3.743710261090171*^9, 3.743710262202159*^9}, {3.7437103085146723`*^9, 
   3.7437103141586123`*^9}, {3.743710367263332*^9, 3.743710390274288*^9}, {
   3.743710473544232*^9, 3.743710476418352*^9}, {3.743710549403823*^9, 
   3.743710577784439*^9}, {3.743710613172068*^9, 3.7437106562282906`*^9}, {
   3.7437106903883343`*^9, 3.743710695374282*^9}, {3.743710979978315*^9, 
   3.7437110231589155`*^9}, {3.743711053706431*^9, 3.743711053894429*^9}, {
   3.7437111409104767`*^9, 3.743711141109474*^9}, {3.743711410756028*^9, 
   3.7437114119980164`*^9}, {3.743711535980961*^9, 3.7437116063041496`*^9}, {
   3.7437118593799458`*^9, 3.743711874918147*^9}, {3.743711944220426*^9, 
   3.743711971892214*^9}, {3.743712017378725*^9, 3.743712131993966*^9}, {
   3.7437121960627213`*^9, 3.743712228257389*^9}, {3.743712423121862*^9, 
   3.743712428442754*^9}, {3.7437124943416557`*^9, 3.7437125266732893`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"51a329d7-018d-475a-b0d8-14b05c76edb8"],

Cell[BoxData[{
 RowBox[{"PrintTemporary", "[", 
  RowBox[{
   RowBox[{"AskFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<template\>\"", "\[Rule]", "  ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
          RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}], ",", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", " ", "Null"}], ",", 
         RowBox[{"\"\<Required\>\"", "\[Rule]", "True"}], ",", 
         RowBox[{"\"\<Control\>\"", "\[Rule]", "PopupMenu"}], ",", 
         RowBox[{"\"\<AutoSubmitting\>\"", "\[Rule]", "True"}]}], "|>"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"argsKvm", "=", 
          RowBox[{"KeyValueMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\"\<\\\"\>\"", "<>", "#1", "<>", "\"\<\\\"\>\""}], 
              "\[Rule]", " ", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                 RowBox[{"formTypeFromDefault", "[", "#2", "]"}]}], ",", " ", 
                
                RowBox[{"\"\<Default\>\"", "\[Rule]", "  ", "#2"}], ",", 
                RowBox[{"\"\<Input\>\"", "\[Rule]", "  ", "#2"}]}], "|>"}]}], 
             "&"}], ",", " ", 
            RowBox[{"extractNotebookTemplateParameters", "[", 
             RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], "]"}]}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}], "=", 
         RowBox[{"KeyMap", "[", 
          RowBox[{"ToExpression", ",", 
           RowBox[{"Ask", "[", "argsKvm", "]"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"createNotebook", "[", 
       RowBox[{
        RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], ",", 
        RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}]}], "]"}]}]}], "]"}],
    "[", "]"}], "]"}], "\[IndentingNewLine]", "CellObject"}], "Input",
 CellChangeTimes->{{3.7437501743394375`*^9, 3.7437501761434183`*^9}, {
  3.7437505513379364`*^9, 3.743750555850767*^9}, {3.74375114075056*^9, 
  3.743751142888626*^9}, {3.7438055114306254`*^9, 
  3.7438055159005313`*^9}},ExpressionUUID->"75a21b9e-c4c3-42d3-8497-\
345038013da6"],

Cell[BoxData["SelectionCloseUnselectedCells"], "Input",
 CellChangeTimes->{{3.743818151429576*^9, 
  3.743818153435557*^9}},ExpressionUUID->"7c59cd9d-9fb8-4037-ab0d-\
9551c036bd3b"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", "Forms`Ask`PackagePrivate`vals", "}"}], ",", " ", 
   RowBox[{"Dynamic", "[", 
    RowBox[{"Forms`Ask`PackagePrivate`vals", ";", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ValueQ", "[", "Forms`Ask`PackagePrivate`vals", "]"}], " ", "&&",
         " ", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"Forms`Ask`PackagePrivate`vals", ",", " ", "Failure"}], 
         "]"}]}], ",", " ", 
       RowBox[{"Forms`Ask`PackagePrivate`dialogReturn", "[", 
        RowBox[{
         RowBox[{"Forms`Ask`PackagePrivate`apply", "[", 
          RowBox[{"Set", ",", " ", "template"}], "]"}], "[", 
         "Forms`Ask`PackagePrivate`vals", "]"}], "]"}]}], "]"}], ";", " ", 
     RowBox[{"Clear", "[", "Forms`Ask`PackagePrivate`vals", "]"}], ";", " ", 
     RowBox[{"Forms`Ask`PackagePrivate`addValue", "[", 
      RowBox[{"template", ",", " ", 
       RowBox[{"FormFunction", "[", 
        RowBox[{"FormObject", "[", 
         RowBox[{
          RowBox[{"<|", 
           RowBox[{"template", " ", "->", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"Interpreter", " ", "->", " ", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"Test", "-", "Template"}], " ", "->", " ", 
                 RowBox[{"TemplateObject", "[", 
                  RowBox[{"NotebookObject", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"<<", "Test"}], "-", 
                    RowBox[{"Template", ".", "nb"}]}], ">>"}], "]"}], "]"}]}],
                 "|>"}]}], ",", " ", 
              RowBox[{"Input", " ", "->", " ", "Null"}], ",", " ", 
              RowBox[{"Required", " ", "->", " ", "True"}], ",", " ", 
              RowBox[{"Control", " ", "->", " ", "PopupMenu"}]}], "|>"}]}], 
           "|>"}], ",", " ", 
          RowBox[{"AppearanceRules", " ", "->", " ", 
           RowBox[{"<|", 
            RowBox[{"CancelLabel", " ", "->", " ", "None"}], "|>"}]}]}], 
         "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Forms`PackageScope`bindForm", "[", 
         RowBox[{
          RowBox[{"FormObject", "[", "#1", "]"}], ",", " ", 
          "Forms`Ask`PackagePrivate`vals", ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Forms`Ask`PackagePrivate`vals", " ", "=", " ", "#1"}], 
            ")"}], " ", "&"}], " ", ",", " ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "Forms`Ask`PackagePrivate`$Env", "]"}], 
              " ", ">", " ", "2"}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "Forms`Ask`PackagePrivate`$Env", ",", " ", 
                 "Forms`PackageScope`$Asked"}], "}"}], " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{"#1", ",", " ", 
                    RowBox[{"-", "2"}]}], "]"}], " ", "&"}], " ", ")"}], " ", 
                "/@", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "Forms`Ask`PackagePrivate`$Env", ",", " ", 
                  "Forms`PackageScope`$Asked"}], "}"}]}]}], ";", " ", 
              RowBox[{
              "Forms`Ask`PackagePrivate`dialogReturn", "[", 
               "Forms`Ask`PackagePrivate`$Back", "]"}]}]}], "]"}], "&"}]}], 
         " ", "]"}], " ", "&"}], " ", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Forms`Ask`PackagePrivate`vals", " ", "=", " ", "#1"}], 
         ")"}], " ", "&"}]}], " ", "]"}]}], "]"}], ",", " ", 
   RowBox[{"DynamicModuleValues", " ", ":>", " ", 
    RowBox[{"{", "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.743803509414152*^9, 3.743803512930118*^9}, 
   3.743803642690925*^9},ExpressionUUID->"ca2131d4-7636-4a65-85e0-\
383f921cff3f"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"PrintTemporary", "=", 
     RowBox[{
      RowBox[{"Set", "[", 
       RowBox[{"printTemporary", ",", "#"}], "]"}], "&"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "@", 
     RowBox[{"Dynamic", "[", "printTemporary", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AskFunction", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<template\>\"", "\[Rule]", "  ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"retrieveTemplateNotebooks", "[", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Input\>\"", "\[Rule]", " ", "Null"}], ",", 
           RowBox[{"\"\<Required\>\"", "\[Rule]", "True"}], ",", 
           RowBox[{"\"\<Control\>\"", "\[Rule]", "PopupMenu"}], ",", 
           RowBox[{"\"\<AutoSubmitting\>\"", "\[Rule]", "True"}]}], "|>"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"argsKvm", "=", 
            RowBox[{"KeyValueMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", "#1", "<>", "\"\<\\\"\>\""}], 
                "\[Rule]", " ", 
                RowBox[{"<|", 
                 RowBox[{
                  RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                   RowBox[{"Evaluate", "[", 
                    RowBox[{"formTypeFromDefault", "[", "#2", "]"}], "]"}]}], 
                  ",", " ", 
                  RowBox[{"\"\<Default\>\"", "\[Rule]", "  ", "#2"}], ",", 
                  RowBox[{"\"\<Input\>\"", "\[Rule]", "  ", "#2"}]}], 
                 "|>"}]}], "&"}], ",", " ", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"extractNotebookTemplateParameters", "[", 
                RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], "]"}], "]"}]}],
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}], "=", 
           RowBox[{"KeyMap", "[", 
            RowBox[{"ToExpression", ",", 
             RowBox[{"Ask", "[", "argsKvm", "]"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"createNotebook", "[", 
         RowBox[{
          RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], ",", 
          RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "[", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7437289129456577`*^9, 3.743728933227556*^9}, 
   3.7437289685859985`*^9, {3.743729003874981*^9, 3.7437290126398897`*^9}, {
   3.743729046995969*^9, 3.743729070715912*^9}, {3.7437291410173674`*^9, 
   3.743729162210145*^9}, {3.7437291993511553`*^9, 3.7437292074111223`*^9}, {
   3.743729344497593*^9, 3.743729398852347*^9}, {3.743729557426796*^9, 
   3.743729574230513*^9}, {3.743730126449628*^9, 3.743730131383628*^9}, {
   3.7437302062317567`*^9, 3.7437302739700327`*^9}, {3.7437304665785265`*^9, 
   3.7437304703485126`*^9}, {3.7437305772888613`*^9, 
   3.7437305797588873`*^9}, {3.7437306255974264`*^9, 3.743730628190451*^9}, {
   3.7437307075163856`*^9, 3.743730708837372*^9}, {3.7437307656337786`*^9, 
   3.743730795064522*^9}, {3.7437308388130884`*^9, 3.7437308973913317`*^9}, {
   3.7437309936890984`*^9, 3.743730997518109*^9}, {3.74373107007353*^9, 
   3.7437310717435656`*^9}, {3.743731408363561*^9, 3.743731430114348*^9}, {
   3.7437316670186377`*^9, 3.743731680331591*^9}, {3.7437317700846596`*^9, 
   3.743731824722087*^9}, 3.7437318680026407`*^9, {3.743731975127468*^9, 
   3.7437320598306212`*^9}, {3.7437320969102983`*^9, 
   3.7437321536054487`*^9}, {3.7437322062852345`*^9, 3.743732235343783*^9}, {
   3.7437323052449512`*^9, 3.7437323595596437`*^9}, {3.743732425865032*^9, 
   3.7437324354860744`*^9}, {3.7437330031073217`*^9, 3.743733035723978*^9}, {
   3.7437332878620358`*^9, 3.7437332893470716`*^9}, {3.743733474263362*^9, 
   3.743733476149341*^9}, {3.743733513394947*^9, 3.7437335444116187`*^9}, {
   3.743733637242732*^9, 3.7437336799932814`*^9}, 3.743734015521983*^9, {
   3.7437340487087293`*^9, 3.7437340807853394`*^9}, {3.7437342872272778`*^9, 
   3.7437342883992133`*^9}, {3.7437343813695574`*^9, 
   3.7437343818344364`*^9}, {3.743734471578096*^9, 3.743734474092122*^9}, {
   3.7437347127573843`*^9, 3.743734753665663*^9}, {3.743735236903017*^9, 
   3.7437352393839903`*^9}, {3.743735450136998*^9, 3.7437355147645545`*^9}, {
   3.743735550888494*^9, 3.7437355652284245`*^9}, {3.743735782061882*^9, 
   3.7437357852109237`*^9}, {3.7437359742121115`*^9, 3.743735994085187*^9}, 
   3.7437361904909096`*^9, {3.7437362283625097`*^9, 3.7437362411633763`*^9}, {
   3.7437364625197906`*^9, 3.7437364627447886`*^9}, {3.743736615866562*^9, 
   3.743736626211453*^9}, 3.7437369894913845`*^9, {3.74373720477671*^9, 
   3.7437372162575645`*^9}, {3.7437372606753387`*^9, 3.743737266553277*^9}, {
   3.7437377475894823`*^9, 3.7437377632943172`*^9}, {3.7437384203414593`*^9, 
   3.7437384254944057`*^9}, {3.7437385886868563`*^9, 
   3.7437385980277576`*^9}, {3.743738744410259*^9, 3.7437388109145365`*^9}, {
   3.7437401194290657`*^9, 3.7437401230700274`*^9}, {3.743740217112255*^9, 
   3.743740227825143*^9}, {3.7437403273946247`*^9, 3.743740343628026*^9}, {
   3.7437420930055637`*^9, 3.7437421140672965`*^9}, 3.7437421941617336`*^9, {
   3.7437513602478766`*^9, 3.7437514320019226`*^9}, {3.7437514659600663`*^9, 
   3.7437514912348113`*^9}, {3.743751658426112*^9, 3.743751688290807*^9}, {
   3.7437517292824373`*^9, 3.743751745478219*^9}, {3.743751840214254*^9, 
   3.7437518788185987`*^9}, {3.743752222492917*^9, 3.7437522389274893`*^9}, {
   3.7437522867091627`*^9, 3.7437523936329412`*^9}, {3.743752496041086*^9, 
   3.743752520960821*^9}, {3.7437526146400404`*^9, 3.74375269364135*^9}, {
   3.743752747503786*^9, 3.743752775464567*^9}, 3.74375281613091*^9, {
   3.743752908695774*^9, 3.7437529135017242`*^9}, {3.743752994192152*^9, 
   3.7437530091680665`*^9}, {3.743753047875428*^9, 3.743753053359358*^9}, {
   3.743753132019106*^9, 3.7437531489160986`*^9}, {3.743753248003753*^9, 
   3.7437532916217537`*^9}, {3.74375338500975*^9, 3.743753455187657*^9}, {
   3.743753588218767*^9, 3.7437536190489264`*^9}, {3.7437536663093786`*^9, 
   3.743753691923822*^9}, {3.7437537888807926`*^9, 3.743753841214794*^9}, {
   3.7437539981004105`*^9, 3.7437540000203896`*^9}, 3.743754410615136*^9, {
   3.743754464706633*^9, 3.7437544834425125`*^9}, {3.7437546262170963`*^9, 
   3.7437546329130774`*^9}, {3.743754892575189*^9, 3.7437548931991825`*^9}, {
   3.743761882847413*^9, 3.74376191439625*^9}, {3.7438011990450516`*^9, 
   3.743801336380856*^9}, {3.743801409324272*^9, 3.743801412847291*^9}, {
   3.743801718217228*^9, 
   3.7438017230221815`*^9}},ExpressionUUID->"2e5f329b-86f4-465d-91b4-\
b7acbb9a1cca"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "printTemporary", "]"}]], "Input",
 CellChangeTimes->{{3.7437553730106444`*^9, 3.743755378776583*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"0e1c0645-5ff4-4aec-87f9-7136300b9d66"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", "printTemporary", "}"}], ",", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PrintTemporary", "=", 
       RowBox[{
        RowBox[{"Set", "[", 
         RowBox[{"printTemporary", ",", "#"}], "]"}], "&"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "@", 
       RowBox[{"Dynamic", "[", "printTemporary", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AskFunction", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<template\>\"", "\[Rule]", "  ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
              RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}], ",", 
             RowBox[{"\"\<Input\>\"", "\[Rule]", " ", "Null"}], ",", 
             RowBox[{"\"\<Required\>\"", "\[Rule]", "True"}], ",", 
             RowBox[{"\"\<Control\>\"", "\[Rule]", "PopupMenu"}], ",", 
             RowBox[{"\"\<AutoSubmitting\>\"", "\[Rule]", "True"}]}], 
            "|>"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"argsKvm", "=", 
              RowBox[{"KeyValueMap", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"\"\<\\\"\>\"", "<>", "#1", "<>", "\"\<\\\"\>\""}], 
                  "\[Rule]", " ", 
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                    RowBox[{"formTypeFromDefault", "[", "#2", "]"}]}], ",", 
                    " ", 
                    RowBox[{"\"\<Default\>\"", "\[Rule]", "  ", "#2"}], ",", 
                    RowBox[{"\"\<Input\>\"", "\[Rule]", "  ", "#2"}]}], 
                   "|>"}]}], "&"}], ",", " ", 
                RowBox[{"extractNotebookTemplateParameters", "[", 
                 RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], "]"}]}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}], "=", 
             RowBox[{"KeyMap", "[", 
              RowBox[{"ToExpression", ",", 
               RowBox[{"Ask", "[", "argsKvm", "]"}]}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"createNotebook", "[", 
           RowBox[{
            RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], ",", 
            RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "[", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.743804991832836*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"dc13727f-e882-42b5-b703-c57d77486122"],

Cell[BoxData[
 RowBox[{"CreatePalette", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"$DefaultManagedTemplateDirectory", "=", " ", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<ManagedTemplates\>\""}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "retrieveTemplateNotebooks", ",", 
       "\[IndentingNewLine]", "extractNotebookTemplateParameters", ",", 
       "\[IndentingNewLine]", "createNotebook", ",", "\[IndentingNewLine]", 
       "formTypeFromDefault"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrieveTemplateNotebooks", "[", 
        RowBox[{"dirs__:", "$DefaultManagedTemplateDirectory"}], "]"}], ":=", 
       
       RowBox[{
        RowBox[{"KeyMap", "[", "FileBaseName", "]"}], " ", "@", " ", 
        RowBox[{"AssociationMap", "[", 
         RowBox[{"NotebookTemplate", ",", " ", 
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<*.nb\>\"", ",", "dirs"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extractNotebookTemplateParameters", "[", "Null", "]"}], "=", 
       "Null"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extractNotebookTemplateParameters", "[", 
        RowBox[{"nb_TemplateObject:", 
         RowBox[{
          RowBox[{"First", "@*", "Values"}], "@", 
          RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}]}], "]"}], ":=", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ToExpression", "[", "#1", "]"}], "\[Rule]", " ", 
            RowBox[{"ToExpression", "[", "#2", "]"}]}], ")"}], "&"}], "@@@", 
         RowBox[{"Sort", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"NotebookGet", "@@", "nb"}], ")"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"TemplateBox", "[", 
              RowBox[{
              "param_List", ",", " ", "\"\<NotebookTemplateSlot\>\""}], "]"}],
              " ", "\[RuleDelayed]", "  ", "param"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"createNotebook", "[", 
        RowBox[{"templateNb_TemplateObject", ",", "args_Association"}], "]"}],
        ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"SetOptions", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Visible", "\[Rule]", "True"}]}], "]"}], ";", 
           RowBox[{"NotebookSave", "[", 
            RowBox[{"#", ",", 
             RowBox[{"RelativeFilePath", "[", 
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"args", ",", "\"\<name\>\"", ",", "\"\<new\>\""}], 
                "]"}], " ", "<>", "\"\<.nb\>\""}], "]"}], ",", 
             RowBox[{"Interactive", "\[Rule]", "True"}]}], "]"}]}], ")"}], 
         "&"}], "[", 
        RowBox[{"TemplateApply", "[", 
         RowBox[{"templateNb", ",", "args"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"formTypeFromDefault", "[", 
        RowBox[{"defVal_", "?", "NumberQ"}], "]"}], ":=", "\"\<Number\>\""}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"formTypeFromDefault", "[", "defVal_", "]"}], ":=", 
       "\"\<String\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"DynamicModule", "[", 
       RowBox[{
        RowBox[{"{", "printTemporary", "}"}], ",", 
        RowBox[{"Dynamic", "[", "printTemporary", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"SynchronousInitialization", "\[Rule]", "False"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Initialization", "\[RuleDelayed]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"PrintTemporary", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Set", "[", 
                 RowBox[{"printTemporary", ",", "#"}], "]"}], ";", 
                RowBox[{"Update", "[", "printTemporary", "]"}]}], ")"}], 
              "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<TEST1\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AskFunction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<template\>\"", "\[Rule]", "  ", 
                 RowBox[{"<|", 
                  RowBox[{
                   RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                    RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}], ",", 
                   RowBox[{"\"\<Input\>\"", "\[Rule]", " ", "Null"}], ",", 
                   RowBox[{"\"\<Required\>\"", "\[Rule]", "True"}], ",", 
                   RowBox[{"\"\<Control\>\"", "\[Rule]", "PopupMenu"}], ",", 
                   RowBox[{"\"\<AutoSubmitting\>\"", "\[Rule]", "True"}]}], 
                  "|>"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"argsKvm", "=", 
                    RowBox[{"KeyValueMap", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "\"\<\\\"\>\"", "<>", "#1", "<>", "\"\<\\\"\>\""}], 
                    "\[Rule]", " ", 
                    RowBox[{"<|", 
                    RowBox[{
                    RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                    RowBox[{"formTypeFromDefault", "[", "#2", "]"}]}], ",", 
                    " ", 
                    RowBox[{"\"\<Default\>\"", "\[Rule]", "  ", "#2"}], ",", 
                    RowBox[{"\"\<Input\>\"", "\[Rule]", "  ", "#2"}]}], 
                    "|>"}]}], "&"}], ",", " ", 
                    RowBox[{"extractNotebookTemplateParameters", "[", 
                    RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], "]"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}], "=", 
                   RowBox[{"KeyMap", "[", 
                    RowBox[{"ToExpression", ",", 
                    RowBox[{"Ask", "[", "argsKvm", "]"}]}], "]"}]}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"createNotebook", "[", 
                 RowBox[{
                  RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], ",", 
                  RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], "[", "]"}]}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}], ",", 
   RowBox[{
   "WindowTitle", "\[Rule]", 
    "\"\<Create Mathematica File From Template\>\""}]}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQ7SfhHb30yWvHtIz8OBDdsGZHNYgWrzetB9Gbyv83
g+ibq4RaQHSUsH8HiLbg9O8G0dZSq6eCaCZr52kguuBx7gIQfe+S+2IQHSt9
dAWIniM0YQ2I1v37YzuI9vqqsANEK61k3geiJZrOgWnLV9+Ogegktm/HQXRe
UeJZEB1w4/55EP35mvRdEL06QP4+iN7F5/sTRMt9nwumVUX/siwDmbcrhg1E
fxdQ5QHRc6r/CoJoNoECdTBfZxKY1unzswDRm3giwfS7M9GhIHrznflg+s7a
67Eg2t7nXDyI5tt36zuIdrMM+gWiXy23kFsOpPXW58iD6HszluuB6F+Ffvog
uiauM3IFkPYX4I8C0fO8Ij6AaKN3qz+DaIt1D76D6Chb/R8g2vb3z98g+pbs
Rt6VQBoAedH0Qg==
  "],ExpressionUUID->"c376255f-227b-4417-987d-32e43e9998e8"],

Cell[BoxData["$$PaletteWorkingDirectory"], "Input",
 CellChangeTimes->{{3.7437667653915825`*^9, 3.7437667676598344`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"18bcc75b-9bd3-4eac-8f5e-94a18d9c7751"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
    RowBox[{"DynamicUpdating", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CreatePalette", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$DefaultManagedTemplateDirectory", "=", " ", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<ManagedTemplates\>\""}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "printTemporary", ",", "\[IndentingNewLine]", 
       "retrieveTemplateNotebooks", ",", "\[IndentingNewLine]", 
       "extractNotebookTemplateParameters", ",", "\[IndentingNewLine]", 
       "createNotebook", ",", "\[IndentingNewLine]", "formTypeFromDefault"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrieveTemplateNotebooks", "[", 
        RowBox[{"dirs__:", "$DefaultManagedTemplateDirectory"}], "]"}], ":=", 
       
       RowBox[{
        RowBox[{"KeyMap", "[", "FileBaseName", "]"}], " ", "@", " ", 
        RowBox[{"AssociationMap", "[", 
         RowBox[{"NotebookTemplate", ",", " ", 
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<*.nb\>\"", ",", "dirs"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extractNotebookTemplateParameters", "[", "Null", "]"}], "=", 
       "Null"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extractNotebookTemplateParameters", "[", 
        RowBox[{"nb_TemplateObject:", 
         RowBox[{
          RowBox[{"First", "@*", "Values"}], "@", 
          RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}]}], "]"}], ":=", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ToExpression", "[", "#1", "]"}], "\[Rule]", " ", 
            RowBox[{"ToExpression", "[", "#2", "]"}]}], ")"}], "&"}], "@@@", 
         RowBox[{"Sort", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"NotebookGet", "@@", "nb"}], ")"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"TemplateBox", "[", 
              RowBox[{
              "param_List", ",", " ", "\"\<NotebookTemplateSlot\>\""}], "]"}],
              " ", "\[RuleDelayed]", "  ", "param"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"createNotebook", "[", 
        RowBox[{"templateNb_TemplateObject", ",", "args_Association"}], "]"}],
        ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"SetOptions", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Visible", "\[Rule]", "True"}]}], "]"}], ";", 
           RowBox[{"NotebookSave", "[", 
            RowBox[{"#", ",", 
             RowBox[{"RelativeFilePath", "[", 
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"args", ",", "\"\<name\>\"", ",", "\"\<new\>\""}], 
                "]"}], " ", "<>", "\"\<.nb\>\""}], "]"}], ",", 
             RowBox[{"Interactive", "\[Rule]", "True"}]}], "]"}]}], ")"}], 
         "&"}], "[", 
        RowBox[{"TemplateApply", "[", 
         RowBox[{"templateNb", ",", "args"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"formTypeFromDefault", "[", 
        RowBox[{"defVal_", "?", "NumberQ"}], "]"}], ":=", "\"\<Number\>\""}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"formTypeFromDefault", "[", "defVal_", "]"}], ":=", 
       "\"\<String\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"PrintTemporary", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Set", "[", 
              RowBox[{"printTemporary", ",", "#"}], "]"}], ";", 
             RowBox[{"Update", "[", 
              RowBox[{"Unevaluated", "[", "printTemporary", "]"}], "]"}]}], 
            ")"}], "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Dynamic", "[", "printTemporary", "]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AskFunction", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<template\>\"", "\[Rule]", "  ", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<Interpreter\>\"", "\[Rule]", 
                 RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}], ",", 
                RowBox[{"\"\<Input\>\"", "\[Rule]", " ", "Null"}], ",", 
                RowBox[{"\"\<Required\>\"", "\[Rule]", "True"}], ",", 
                RowBox[{"\"\<Control\>\"", "\[Rule]", "PopupMenu"}]}], 
               "|>"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"argsKvm", "=", 
                 RowBox[{"KeyValueMap", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "\"\<\\\"\>\"", "<>", "#1", "<>", "\"\<\\\"\>\""}], 
                    "\[Rule]", " ", 
                    RowBox[{"<|", 
                    RowBox[{
                    RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                    RowBox[{"Echo", "@", 
                    RowBox[{"formTypeFromDefault", "[", "#2", "]"}]}]}], ",", 
                    " ", 
                    RowBox[{"\"\<Default\>\"", "\[Rule]", "  ", "#2"}], ",", 
                    RowBox[{"\"\<Input\>\"", "\[Rule]", "  ", "#2"}]}], 
                    "|>"}]}], "&"}], ",", " ", 
                   RowBox[{"Echo", "@", 
                    RowBox[{"extractNotebookTemplateParameters", "[", 
                    RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], "]"}]}]}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}], "=", 
                RowBox[{"KeyMap", "[", 
                 RowBox[{"ToExpression", ",", 
                  RowBox[{"Ask", "[", "argsKvm", "]"}]}], "]"}]}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"createNotebook", "[", 
              RowBox[{
               RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], ",", 
               RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}]}], "]"}]}]}],
            "\[IndentingNewLine]", "]"}], "[", "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{
   "WindowTitle", "\[Rule]", 
    "\"\<Create Mathematica File From Template\>\""}], ",", 
   RowBox[{"DynamicUpdating", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7437591527619686`*^9, 3.743759214865093*^9}, {
   3.7437605811746826`*^9, 3.743760585673688*^9}, {3.7437606852552586`*^9, 
   3.743760687544286*^9}, {3.7437609641234922`*^9, 3.743760965630424*^9}, {
   3.7437611116720495`*^9, 3.7437611821772523`*^9}, {3.743761248629641*^9, 
   3.743761273788683*^9}, {3.7437614005461845`*^9, 3.743761412392565*^9}, {
   3.74376200834094*^9, 3.7437620230888433`*^9}, 3.743762125711813*^9, {
   3.7437621878075075`*^9, 3.7437622096342154`*^9}, {3.743762589180195*^9, 
   3.743762629062957*^9}, {3.743762732184656*^9, 3.7437627356146193`*^9}, {
   3.7437627925148554`*^9, 3.743762794736883*^9}, 3.7437628884937716`*^9, {
   3.7437629712281256`*^9, 3.7437629793900394`*^9}, 3.7437631042840767`*^9, {
   3.7437631865505238`*^9, 3.743763203028491*^9}, {3.7437632905545435`*^9, 
   3.743763295851538*^9}, 3.7437634193984804`*^9, {3.7437635734787846`*^9, 
   3.743763575727761*^9}, {3.743763846855119*^9, 3.7437638478101597`*^9}, {
   3.7437639164965773`*^9, 3.743763920263588*^9}, 3.7437639862629414`*^9, {
   3.7437640642863555`*^9, 3.7437640679263163`*^9}, {3.7437641008165445`*^9, 
   3.7437641028825235`*^9}, 3.7437642231422505`*^9, {3.7437642662403364`*^9, 
   3.743764359433312*^9}, 3.7437647441332245`*^9, 3.7437647984719677`*^9, {
   3.7437652033413715`*^9, 3.7437652238572855`*^9}, {3.7437653089789357`*^9, 
   3.7437653117839055`*^9}, {3.743765436826467*^9, 3.743765481258299*^9}, 
   3.7437655592600756`*^9, 3.7437656353823433`*^9, {3.7437666995597486`*^9, 
   3.7437667055168724`*^9}, {3.7437667579445763`*^9, 3.743766774257966*^9}, {
   3.7438043047772408`*^9, 3.743804331360984*^9}, {3.7438049080676827`*^9, 
   3.743804908589739*^9}, {3.7438050190906296`*^9, 3.743805026702441*^9}, {
   3.7438051348652716`*^9, 3.743805135441266*^9}, {3.743805258325279*^9, 
   3.7438052627631845`*^9}, {3.743816136974287*^9, 3.743816161886734*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"3ae69968-1ee5-4137-a1e2-6d4c788a3c49"],

Cell[BoxData[
 RowBox[{"Format", "@", 
  DynamicBox[ToBoxes[$CellContext`printTemporary$61630, StandardForm],
   ImageSizeCache->{218., {4., 14.}}]}]], "Input",
 CellChangeTimes->{{3.743889664422015*^9, 3.7438896917376976`*^9}, {
  3.7438897385885*^9, 3.743889740921414*^9}, {3.7438898071747212`*^9, 
  3.743889831884429*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"1908da5b-5783-44d3-bd2e-4e94eef4135a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
    RowBox[{"DynamicUpdating", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CreatePalette", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$DefaultManagedTemplateDirectory", "=", " ", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "$$PaletteWorkingDirectory", ",", "\"\<ManagedTemplates\>\""}], 
          "}"}], "]"}]}], ",", "\[IndentingNewLine]", "printTemporary", ",", 
       "\[IndentingNewLine]", "retrieveTemplateNotebooks", ",", 
       "\[IndentingNewLine]", "extractNotebookTemplateParameters", ",", 
       "\[IndentingNewLine]", "createNotebook", ",", "\[IndentingNewLine]", 
       "formTypeFromDefault"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrieveTemplateNotebooks", "[", 
        RowBox[{"dirs__:", "$DefaultManagedTemplateDirectory"}], "]"}], ":=", 
       
       RowBox[{
        RowBox[{"KeyMap", "[", "FileBaseName", "]"}], " ", "@", " ", 
        RowBox[{"AssociationMap", "[", 
         RowBox[{"NotebookTemplate", ",", " ", 
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<*.nb\>\"", ",", "dirs"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extractNotebookTemplateParameters", "[", "Null", "]"}], "=", 
       "Null"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extractNotebookTemplateParameters", "[", 
        RowBox[{"nb_TemplateObject:", 
         RowBox[{
          RowBox[{"First", "@*", "Values"}], "@", 
          RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}]}], "]"}], ":=", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ToExpression", "[", "#1", "]"}], "\[Rule]", " ", 
            RowBox[{"ToExpression", "[", "#2", "]"}]}], ")"}], "&"}], "@@@", 
         RowBox[{"Sort", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"NotebookGet", "@@", "nb"}], ")"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"TemplateBox", "[", 
              RowBox[{
              "param_List", ",", " ", "\"\<NotebookTemplateSlot\>\""}], "]"}],
              " ", "\[RuleDelayed]", "  ", "param"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"createNotebook", "[", 
        RowBox[{"templateNb_TemplateObject", ",", "args_Association"}], "]"}],
        ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"SetOptions", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Visible", "\[Rule]", "True"}]}], "]"}], ";", 
           RowBox[{"NotebookSave", "[", 
            RowBox[{"#", ",", 
             RowBox[{"RelativeFilePath", "[", 
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"args", ",", "\"\<name\>\"", ",", "\"\<new\>\""}], 
                "]"}], " ", "<>", "\"\<.nb\>\""}], "]"}], ",", 
             RowBox[{"Interactive", "\[Rule]", "True"}]}], "]"}]}], ")"}], 
         "&"}], "[", 
        RowBox[{"TemplateApply", "[", 
         RowBox[{"templateNb", ",", "args"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"formTypeFromDefault", "[", 
        RowBox[{"defVal_", "?", "NumberQ"}], "]"}], ":=", "\"\<Number\>\""}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"formTypeFromDefault", "[", "defVal_", "]"}], ":=", 
       "\"\<String\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DefaultButton", "[", "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"PrintTemporary", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Set", "[", 
                  RowBox[{"printTemporary", ",", "#"}], "]"}], ";", 
                 RowBox[{"Update", "[", 
                  RowBox[{"Unevaluated", "[", "printTemporary", "]"}], 
                  "]"}]}], ")"}], "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{
             RowBox[{"AskFunction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<template\>\"", "\[Rule]", "  ", 
                 RowBox[{"<|", 
                  RowBox[{
                   RowBox[{"\"\<Interpreter\>\"", "\[Rule]", 
                    RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}], ",", 
                   RowBox[{"\"\<Input\>\"", "\[Rule]", " ", "Null"}], ",", 
                   RowBox[{"\"\<Required\>\"", "\[Rule]", "True"}], ",", 
                   RowBox[{"\"\<Control\>\"", "\[Rule]", "PopupMenu"}]}], 
                  "|>"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"argsKvm", "=", 
                    RowBox[{"KeyValueMap", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "\"\<\\\"\>\"", "<>", "#1", "<>", "\"\<\\\"\>\""}], 
                    "\[Rule]", " ", 
                    RowBox[{"<|", 
                    RowBox[{
                    RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                    RowBox[{"formTypeFromDefault", "[", "#2", "]"}]}], ",", 
                    " ", 
                    RowBox[{"\"\<Default\>\"", "\[Rule]", "  ", "#2"}], ",", 
                    RowBox[{"\"\<Input\>\"", "\[Rule]", "  ", "#2"}]}], 
                    "|>"}]}], "&"}], ",", " ", 
                    RowBox[{"extractNotebookTemplateParameters", "[", 
                    RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], "]"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}], "=", 
                   RowBox[{"KeyMap", "[", 
                    RowBox[{"ToExpression", ",", 
                    RowBox[{"Ask", "[", "argsKvm", "]"}]}], "]"}]}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"createNotebook", "[", 
                 RowBox[{
                  RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], ",", 
                  RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], "[", "]"}]}], "]"}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Dynamic", "[", "printTemporary", "]"}]}], "}"}], 
       "\[IndentingNewLine]", "]"}]}]}], "]"}], ",", 
   RowBox[{
   "WindowTitle", "\[Rule]", 
    "\"\<Create Mathematica File From Template\>\""}], ",", 
   RowBox[{"DynamicUpdating", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7437591527619686`*^9, 3.743759214865093*^9}, {
   3.7437605811746826`*^9, 3.743760585673688*^9}, {3.7437606852552586`*^9, 
   3.743760687544286*^9}, {3.7437609641234922`*^9, 3.743760965630424*^9}, {
   3.7437611116720495`*^9, 3.7437611821772523`*^9}, {3.743761248629641*^9, 
   3.743761273788683*^9}, {3.7437614005461845`*^9, 3.743761412392565*^9}, {
   3.74376200834094*^9, 3.7437620230888433`*^9}, 3.743762125711813*^9, {
   3.7437621878075075`*^9, 3.7437622096342154`*^9}, {3.743762589180195*^9, 
   3.743762629062957*^9}, {3.743762732184656*^9, 3.7437627356146193`*^9}, {
   3.7437627925148554`*^9, 3.743762794736883*^9}, 3.7437628884937716`*^9, {
   3.7437629712281256`*^9, 3.7437629793900394`*^9}, 3.7437631042840767`*^9, {
   3.7437631865505238`*^9, 3.743763203028491*^9}, {3.7437632905545435`*^9, 
   3.743763295851538*^9}, 3.7437634193984804`*^9, {3.7437635734787846`*^9, 
   3.743763575727761*^9}, {3.743763846855119*^9, 3.7437638478101597`*^9}, {
   3.7437639164965773`*^9, 3.743763920263588*^9}, 3.7437639862629414`*^9, {
   3.7437640642863555`*^9, 3.7437640679263163`*^9}, {3.7437641008165445`*^9, 
   3.7437641028825235`*^9}, 3.7437642231422505`*^9, {3.7437642662403364`*^9, 
   3.743764359433312*^9}, 3.7437647441332245`*^9, 3.7437647984719677`*^9, {
   3.7437652033413715`*^9, 3.7437652238572855`*^9}, {3.7437653089789357`*^9, 
   3.7437653117839055`*^9}, {3.743765436826467*^9, 3.743765481258299*^9}, 
   3.7437655592600756`*^9, {3.7437656353823433`*^9, 3.7437656801946526`*^9}, {
   3.7437657333790903`*^9, 3.7437657355800667`*^9}, {3.743766381208663*^9, 
   3.743766383484639*^9}, {3.74376656812969*^9, 3.7437665959293914`*^9}, 
   3.743766886421153*^9, {3.7437669766831446`*^9, 3.743767030513643*^9}, {
   3.7437670898507295`*^9, 3.743767137386225*^9}, 3.7437673965317307`*^9, {
   3.743767929028495*^9, 3.7437679377502575`*^9}, {3.7437680020717525`*^9, 
   3.7437680227419543`*^9}, {3.743768206492887*^9, 3.7437682186057587`*^9}, 
   3.7437682561073103`*^9, 3.743768311833455*^9, 3.743768360047805*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"533df61a-e2ea-493a-828e-bf37136201dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreatePalette", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Button", "[", 
     RowBox[{"\"\<New Package\>\"", ",", "\[IndentingNewLine]", " ", 
      RowBox[{"Catch", "@", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "theName", ",", "name", ",", "document", ",", "directory", ",", 
           "nb"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"theName", "=", 
           RowBox[{"InputString", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"name", "=", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"theName", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Except", "[", "WordCharacter", "]"}], "\[Rule]", 
               "\"\<\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"name", "===", "\"\<\>\""}], ",", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"document", "=", "\[IndentingNewLine]", 
           RowBox[{"DocumentNotebook", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"TextCell", "[", 
                  RowBox[{"#", ",", "\"\<Title\>\"", ",", 
                   RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}], 
                 "&"}], "[", 
                RowBox[{"name", "<>", "\"\<.m package\>\""}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"TextCell", "[", 
                RowBox[{"\"\<Begin the package\>\"", ",", "\"\<Section\>\""}],
                 "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"ExpressionCell", "[", 
                  RowBox[{
                   RowBox[{"Defer", "[", 
                    RowBox[{"BeginPackage", "[", "#", "]"}], "]"}], ",", 
                   "\"\<Input\>\""}], "]"}], "&"}], "[", 
                RowBox[{"name", "<>", "\"\<`\>\""}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"TextCell", "[", 
                RowBox[{
                "\"\<Usage messages for the public functions\>\"", ",", 
                 "\"\<Subsection\>\""}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"ExpressionCell", "[", 
                RowBox[{
                 RowBox[{"Defer", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MyFunction", "::", "usage"}], "=", 
                    "\"\<MyFunction[x] is a function that does \
something.\>\""}], ";"}], "]"}], ",", "\"\<Input\>\""}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"TextCell", "[", 
                RowBox[{
                "\"\<Begin the `Private context\>\"", ",", 
                 "\"\<Section\>\""}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"ExpressionCell", "[", 
                RowBox[{
                 RowBox[{"Defer", "[", 
                  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "]"}], 
                 ",", "\"\<Input\>\""}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"TextCell", "[", 
                RowBox[{
                "\"\<Function definitions\>\"", ",", "\"\<Subsection\>\""}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"ExpressionCell", "[", 
                RowBox[{
                 RowBox[{"Defer", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MyFunction", "[", "x", "]"}], ":=", "x"}], ";"}],
                   "]"}], ",", "\"\<Input\>\""}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"TextCell", "[", 
                RowBox[{
                "\"\<End the `Private context\>\"", ",", "\"\<Section\>\""}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"ExpressionCell", "[", 
                RowBox[{
                 RowBox[{"Defer", "[", 
                  RowBox[{"End", "[", "]"}], "]"}], ",", "\"\<Input\>\""}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"TextCell", "[", 
                RowBox[{
                "\"\<End the package context\>\"", ",", "\"\<Section\>\""}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"ExpressionCell", "[", 
                RowBox[{
                 RowBox[{"Defer", "[", 
                  RowBox[{"EndPackage", "[", "]"}], "]"}], ",", 
                 "\"\<Input\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"StyleDefinitions", "\[Rule]", 
              RowBox[{"Notebook", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Cell", "[", 
                   RowBox[{"StyleData", "[", 
                    RowBox[{
                    "StyleDefinitions", "\[Rule]", "\"\<Default.nb\>\""}], 
                    "]"}], "]"}], ",", 
                  RowBox[{"Cell", "[", 
                   RowBox[{
                    RowBox[{"StyleData", "[", "\"\<Code\>\"", "]"}], ",", 
                    RowBox[{"PageWidth", "\[Rule]", "WindowWidth"}], ",", 
                    RowBox[{"AutoIndent", "\[Rule]", "Automatic"}], ",", 
                    RowBox[{"AutoSpacing", "\[Rule]", "True"}], ",", 
                    RowBox[{"LineBreakWithin", "\[Rule]", "Automatic"}], ",", 
                    
                    RowBox[{"LineIndent", "\[Rule]", "1"}], ",", 
                    RowBox[{"LinebreakAdjustments", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.85", ",", "2", ",", "10", ",", "0", ",", "1"}],
                     "}"}]}]}], "]"}], ",", 
                  RowBox[{"Cell", "[", 
                   RowBox[{
                    RowBox[{"StyleData", "[", "\"\<Input\>\"", "]"}], ",", 
                    RowBox[{"InitializationCell", "\[Rule]", "True"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"Visible", "\[Rule]", "False"}], ",", 
                RowBox[{
                "StyleDefinitions", "\[Rule]", 
                 "\"\<PrivateStylesheetFormatting.nb\>\""}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"nb", "=", 
           RowBox[{"CreateWindow", "[", "document", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"directory", "=", 
           RowBox[{"SystemDialogInput", "[", "\"\<Directory\>\"", "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"directory", "===", "$Canceled"}], ",", 
            RowBox[{"Throw", "[", "$Canceled", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"NotebookSave", "[", 
           RowBox[{"nb", ",", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{"directory", ",", 
               RowBox[{"name", "<>", "\"\<.nb\>\""}]}], "}"}], "]"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"12", ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", "Bold", 
         ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"WindowTitle", "\[Rule]", "\"\<New Package\>\""}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7433187577913814`*^9, 3.743318778885154*^9}, {
   3.7436853978018804`*^9, 3.7436854074207273`*^9}, {3.7436870443457212`*^9, 
   3.743687045491761*^9}, 3.7437326071886635`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"aa395a04-cbe5-421b-946e-3b9705bc42aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractNotebookTemplateParameters", "[", 
   RowBox[{"nb_TemplateObject:", 
    RowBox[{
     RowBox[{"First", "@*", "Values"}], "@", 
     RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#1", "\[Rule]", " ", "#2"}], ")"}], "&"}], "@@@", 
    RowBox[{"Sort", "@", 
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NotebookGet", "@@", "nb"}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"TemplateBox", "[", 
         RowBox[{"param_List", ",", " ", "\"\<NotebookTemplateSlot\>\""}], 
         "]"}], " ", "\[RuleDelayed]", "  ", "param"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",\
ExpressionUUID->"9c52f7a9-8d67-406a-9d3e-2744794f305d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractNotebookTemplateParameters", "[", 
   RowBox[{"nb_TemplateObject:", 
    RowBox[{
     RowBox[{"First", "@*", "Values"}], "@", 
     RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ToExpression", "[", "#1", "]"}], "\[Rule]", " ", 
       RowBox[{"ToExpression", "[", "#2", "]"}]}], ")"}], "&"}], "@@@", 
    RowBox[{"Sort", "@", 
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NotebookGet", "@@", "nb"}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"TemplateBox", "[", 
         RowBox[{"param_List", ",", " ", "\"\<NotebookTemplateSlot\>\""}], 
         "]"}], " ", "\[RuleDelayed]", "  ", "param"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",\
ExpressionUUID->"ff731b02-35af-40a9-b7e5-161f25709b46"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Palette work", "Section",
 CellChangeTimes->{{3.743318982987432*^9, 3.743318991603479*^9}, {
  3.7433190278642006`*^9, 
  3.7433190362161107`*^9}},ExpressionUUID->"8dd449b7-d98c-4362-a681-\
1e42cd06bccc"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<PacletManager`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<GeneralUtilities`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.744085993184857*^9, 3.744085993188431*^9}, {
  3.744174909335807*^9, 3.744174918906842*^9}, {3.744174954648828*^9, 
  3.744174961212579*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"efacb65c-b55d-4d97-a744-43fbf6fa9e3d"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7439882259787703`*^9, 3.7439882276737537`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"60284711-1268-4276-8c3c-df68d9df88c6"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "$DefaultManagedTemplateDirectory", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$DefaultManagedTemplateDirectory", "=", " ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<ManagedTemplates\>\""}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "retrieveTemplateNotebooks", ",", "extractNotebookTemplateParameters", ",", 
   "createNotebook", ",", "formTypeFromDefault", ",", 
   "templateParameterForm"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"retrieveTemplateNotebooks", "[", 
   RowBox[{"dirs__:", "$DefaultManagedTemplateDirectory"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"KeyMap", "[", "FileBaseName", "]"}], " ", "@", " ", 
   RowBox[{"AssociationMap", "[", 
    RowBox[{"NotebookTemplate", ",", " ", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*.nb\>\"", ",", "dirs"}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extractNotebookTemplateParameters", "[", "Null", "]"}], "=", 
   "Null"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extractNotebookTemplateParameters", "[", 
    RowBox[{"nb_TemplateObject:", 
     RowBox[{
      RowBox[{"First", "@*", "Values"}], "@", 
      RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ToExpression", "[", "#1", "]"}], "\[Rule]", " ", 
        RowBox[{"ToExpression", "[", "#2", "]"}]}], ")"}], "&"}], "@@@", 
     RowBox[{"Sort", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"NotebookGet", "@@", "nb"}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"TemplateBox", "[", 
          RowBox[{"param_List", ",", " ", "\"\<NotebookTemplateSlot\>\""}], 
          "]"}], " ", "\[RuleDelayed]", "  ", "param"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createNotebook", "[", 
   RowBox[{"templateNb_TemplateObject", ",", "args_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SetOptions", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Visible", "\[Rule]", "True"}]}], "]"}], ";", 
      RowBox[{"NotebookSave", "[", 
       RowBox[{"#", ",", 
        RowBox[{"RelativeFilePath", "[", 
         RowBox[{
          RowBox[{"Lookup", "[", 
           RowBox[{"args", ",", "\"\<name\>\"", ",", "\"\<new\>\""}], "]"}], 
          " ", "<>", "\"\<.nb\>\""}], "]"}], ",", 
        RowBox[{"Interactive", "\[Rule]", "True"}]}], "]"}]}], ")"}], "&"}], 
   "[", 
   RowBox[{"TemplateApply", "[", 
    RowBox[{"templateNb", ",", "args"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formTypeFromDefault", "[", 
   RowBox[{"defVal_", "?", "NumberQ"}], "]"}], ":=", 
  "\"\<Number\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formTypeFromDefault", "[", "defVal_", "]"}], ":=", 
  "\"\<String\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "templateParameterForm", "[", "templateObject_TemplateObject", "]"}], ":=", 
   RowBox[{"FormFunction", "[", 
    RowBox[{
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"formTypeFromDefault", "[", "#2", "]"}], "\[Rule]", " ", 
          "#2"}]}], "&"}], ",", " ", 
       RowBox[{
       "extractNotebookTemplateParameters", "[", "templateObject", "]"}]}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{"Curry", "[", "createNotebook", "]"}], "[", "templateObject", 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "EvaluateStepwiseDynamicOutput", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "EvaluateStepwiseDynamicOutput", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateStepwiseDynamicOutput", "[", "expr_", "]"}], ":=", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"$DynamicOutput", "=", 
       RowBox[{"ProgressIndicator", "[", 
        RowBox[{"Appearance", "\[Rule]", " ", "\"\<Percolate\>\""}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Deploy", "@", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"Refresh", "[", 
        RowBox[{"$DynamicOutput", ",", 
         RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
          RowBox[{"{", "$DynamicOutput", "}"}]}]}], "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"SynchronousInitialization", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"SaveDefinitions", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Initialization", "\[RuleDelayed]", " ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"PrintTemporary", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"$DynamicOutput", " ", "=", " ", "#"}], ")"}], "&"}]}], 
         "}"}], " ", ",", " ", 
        RowBox[{
         RowBox[{"$DynamicOutput", "=", "expr"}], ";", 
         RowBox[{"FinishDynamic", "[", "]"}], ";", 
         RowBox[{"PrintTemporary", "=", "Null"}]}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"askFn1", "=", 
   RowBox[{"AskFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<template\>\"", "\[Rule]", "  ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Interpreter\>\"", "\[Rule]", 
          RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}], ",", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", "Null"}], ",", 
         RowBox[{"\"\<Required\>\"", "\[Rule]", "True"}], ",", 
         RowBox[{"\"\<Control\>\"", "\[Rule]", "PopupMenu"}]}], "|>"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}], "=", 
       RowBox[{"KeyMap", "[", "\[IndentingNewLine]", 
        RowBox[{"ToExpression", ",", "\[IndentingNewLine]", 
         RowBox[{"Ask", "[", 
          RowBox[{"KeyValueMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\"\<\\\"\>\"", "<>", "#1", "<>", "\"\<\\\"\>\""}], 
              "\[Rule]", " ", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<Interpreter\>\"", "\[Rule]", " ", 
                 RowBox[{"formTypeFromDefault", "[", "#2", "]"}]}], ",", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<Default\>\"", "\[Rule]", "  ", "#2"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<Input\>\"", "\[Rule]", "  ", "#2"}]}], "|>"}]}], 
             "&"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"extractNotebookTemplateParameters", "[", 
             RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], "]"}]}], "]"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], ",", 
           RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}], ",", 
           RowBox[{"AskState", "[", "]"}]}], "}"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"TemplateApply", "[", 
       RowBox[{
        RowBox[{"Ask", "[", "\"\<template\>\"", "]"}], ",", 
        RowBox[{"Ask", "[", "\"\<templateArgs\>\"", "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"swa1", ":=", 
  RowBox[{"EvaluateStepwiseDynamicOutput", "[", "\[IndentingNewLine]", 
   RowBox[{"askFn1", "[", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"createPalette", ":=", 
  RowBox[{"CreatePalette", "[", "swa1", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "pauseBetween", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "pauseBetween", "]"}], "=", 
   RowBox[{"{", "HoldAllComplete", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "pauseBetween", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"PauseBetween", "\[Rule]", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pauseBetween", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lcorrect", ":", 
     RowBox[{
      RowBox[{"PatternSequence", "[", 
       RowBox[{
        RowBox[{"Pause", "[", 
         RowBox[{
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{"#", "==", 
             RowBox[{"OptionValue", "[", "PauseBetween", "]"}]}], ")"}]}], 
          "&"}], "]"}], ",", 
        RowBox[{
         RowBox[{"_", "?", 
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Pause", "[", 
              RowBox[{
               RowBox[{"_", "?", 
                RowBox[{"(", 
                 RowBox[{"#", "==", 
                  RowBox[{"OptionValue", "[", "PauseBetween", "]"}]}], 
                 ")"}]}], "&"}], "]"}]}], "]"}]}]}], "&"}]}], "]"}], 
      "..."}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expr_", "?", 
      RowBox[{"!", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Pause", "[", 
          RowBox[{
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{"#", "==", 
              RowBox[{"OptionValue", "[", "PauseBetween", "]"}]}], ")"}]}], 
           "&"}], "]"}]}], "]"}]}]}], "&"}], ",", "\[IndentingNewLine]", 
    "rAny___", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", " ", 
  RowBox[{"pauseBetween", "[", 
   RowBox[{"lcorrect", ",", 
    RowBox[{"Pause", "[", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"OptionValue", "[", "PauseBetween", "]"}], "]"}], "]"}], ",", 
    "expr", ",", "rAny"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.743406114599327*^9, 3.743406194272724*^9}, {
   3.743408352104004*^9, 3.743408437535899*^9}, {3.7436873947361326`*^9, 
   3.743687399273085*^9}, 3.743711618550579*^9, {3.7437171045080595`*^9, 
   3.7437171081600213`*^9}, {3.7437271257212915`*^9, 3.7437271272063284`*^9}, 
   3.743727522577302*^9, {3.7437278568744173`*^9, 3.743727863654346*^9}, {
   3.7437279222038126`*^9, 3.7437279292167454`*^9}, {3.7437286515887175`*^9, 
   3.7437286725365267`*^9}, {3.7437295297780957`*^9, 
   3.7437295324430065`*^9}, {3.743729693429491*^9, 3.743729696009516*^9}, {
   3.743729812092824*^9, 3.7437298294356422`*^9}, {3.7437303235395155`*^9, 
   3.7437303374943666`*^9}, 3.743731202930086*^9, {3.7439169948306103`*^9, 
   3.743916998859573*^9}, 3.743967518768087*^9, {3.7441750512419987`*^9, 
   3.7441750578199997`*^9}, {3.744175113680458*^9, 3.744175143826171*^9}, {
   3.744175179162642*^9, 3.744175216255241*^9}, {3.74417712404629*^9, 
   3.744177266525464*^9}, {3.7441773919066963`*^9, 
   3.744177401214604*^9}},ExpressionUUID->"a521d1de-257a-4e15-ad5d-\
4a474a03b1d0"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.744175049754973*^9, {3.744175086249105*^9, 3.7441750899816227`*^9}, 
   3.7441772408645363`*^9},ExpressionUUID->"af2a42e0-129e-41af-ba0d-\
f5c2f56e89db"],

Cell[BoxData[{
 RowBox[{"to1", "=", 
  RowBox[{
   RowBox[{"First", "@*", "Values"}], "@", 
   RowBox[{"retrieveTemplateNotebooks", "[", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"p1", "=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"extractNotebookTemplateParameters", "[", "to1", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<string1\>\"", "\[Rule]", "\"\<newStr1\>\""}], ",", 
      RowBox[{"\"\<1\>\"", "\[Rule]", "11"}], ",", 
      RowBox[{"\"\<int1\>\"", "\[Rule]", "111"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"createNotebook", "[", 
  RowBox[{"to1", ",", "p1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"p1", "[", 
     RowBox[{"[", "\"\<string1\>\"", "]"}], "]"}], "=", 
    RowBox[{
    "\"\<newString1\>\"", "\[IndentingNewLine]", "p1", "\[IndentingNewLine]", 
     
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", 
            RowBox[{"InputForm", "[", "#1", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"#2", ",", 
            RowBox[{"Head", "[", "#2", "]"}]}], "}"}]}], "}"}], "&"}], ",", 
       "p1"}], "]"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.743409275334981*^9, 3.7434092781701727`*^9}, {
   3.7434102593013287`*^9, 3.743410284984929*^9}, {3.7434103403825607`*^9, 
   3.743410351305915*^9}, {3.743410483839911*^9, 3.7434105089452887`*^9}, {
   3.7434106047015247`*^9, 3.743410639865567*^9}, {3.743410824138483*^9, 
   3.7434108648902407`*^9}, 3.743410912862914*^9, {3.7434110083863077`*^9, 
   3.743411012656252*^9}, {3.743693914313809*^9, 3.7436939642597065`*^9}, 
   3.743694000415186*^9, {3.743726354708699*^9, 3.743726482502534*^9}, {
   3.7437265517017317`*^9, 3.743726646585395*^9}, {3.7437266790943394`*^9, 
   3.7437266825013046`*^9}, {3.7437267176289477`*^9, 
   3.7437267188329363`*^9}, {3.7437269919598675`*^9, 3.743726992433915*^9}, 
   3.743727940068625*^9, {3.7437280614168763`*^9, 3.7437280653498363`*^9}, {
   3.7437281302334166`*^9, 3.743728209644806*^9}, {3.7437282473413734`*^9, 
   3.7437282789480457`*^9}, {3.74372843070181*^9, 3.7437284985260973`*^9}, {
   3.743728609484137*^9, 3.74372862560802*^9}, {3.7437286918342724`*^9, 
   3.743728714867093*^9}, {3.743729673980695*^9, 3.743729686176585*^9}, {
   3.743729720299446*^9, 3.7437297952156906`*^9}, {3.743729866582201*^9, 
   3.743729895974018*^9}, {3.7437299345848045`*^9, 3.743730001606817*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0267ab6d-8ecb-4718-85c2-db067d61922e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pauseBetween", "[", 
  RowBox[{
   RowBox[{"PrintTemporary", "[", "\"\<TestSEI-1\>\"", "]"}], ",", 
   RowBox[{"PrintTemporary", "[", "\"\<TestSEI-2\>\"", "]"}], ",", 
   "\"\<TestSEI-3\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.743885649463393*^9, 3.743885715348686*^9}, {
   3.7438892434291687`*^9, 3.7438892576340313`*^9}, {3.7439631932908163`*^9, 
   3.7439632017257423`*^9}, {3.7439660189690094`*^9, 
   3.7439660199929996`*^9}, {3.7440643350796647`*^9, 3.7440643491635327`*^9}, 
   3.744064542233054*^9, 3.7440695696257143`*^9, {3.7440713998159213`*^9, 
   3.7440714010629053`*^9}, {3.7440724531327477`*^9, 
   3.7440724973631887`*^9}, {3.7440725791765556`*^9, 3.744072580201542*^9}, {
   3.7440731630801473`*^9, 3.744073165770113*^9}, {3.744073205108576*^9, 
   3.744073253299904*^9}, 3.744073471608798*^9},
 CellLabel->
  "In[201]:=",ExpressionUUID->"0928a9be-db55-4a51-a345-39f20311c79a"],

Cell[BoxData[
 RowBox[{"pauseBetween", "[", 
  RowBox[{
   RowBox[{"PrintTemporary", "[", "\<\"TestSEI-1\"\>", "]"}], ",", 
   RowBox[{"PrintTemporary", "[", "\<\"TestSEI-2\"\>", "]"}], 
   ",", "\<\"TestSEI-3\"\>"}], "]"}]], "Output",
 CellChangeTimes->{
  3.744064568184722*^9, {3.744064618156108*^9, 3.7440646746475377`*^9}, {
   3.7440650041695995`*^9, 3.744065039866166*^9}, 3.7440650709837847`*^9, 
   3.7440673446324215`*^9, 3.7440692104045725`*^9, 3.7440695122956104`*^9, 
   3.7440695516249247`*^9, {3.7440724987921176`*^9, 3.744072506076027*^9}, 
   3.7440725481097684`*^9, {3.7440725839766254`*^9, 3.744072593358451*^9}, 
   3.744072631097451*^9, {3.7440726799008355`*^9, 3.744072708576284*^9}, 
   3.744072781719398*^9, {3.7440728184519362`*^9, 3.7440728554883165`*^9}, 
   3.744072894070345*^9, {3.7440729811397696`*^9, 3.7440729930415134`*^9}, {
   3.744073155827113*^9, 3.7440731695480137`*^9}, {3.744073221593317*^9, 
   3.7440732436640415`*^9}, 3.744073674426238*^9, 3.744074600443031*^9, 
   3.7440748644770775`*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"35b6428e-fb3b-483d-b2f4-abe86c4b5358"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{"Appearance", "\[Rule]", "a"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Indeterminate\>\"", ",", "\"\<Necklace\>\"", ",", "\"\<ArcUp\>\"", 
       ",", "\"\<ArcDown\>\"", ",", "\"\<ArcUpFill\>\"", ",", 
       "\"\<Percolate\>\"", ",", "\"\<Ellipsis\>\""}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.74389153767091*^9, 3.7438915376739616`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"6855031c-4680-4d24-a2a9-cd40b1ad729b"]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1436, 855},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification:>1.4 Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "BStyle.nb"]]}, Visible -> False, 
  FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 164, 3, 77, "Subsection",ExpressionUUID->"7ffb15db-563a-4366-9671-a836765c6757"],
Cell[CellGroupData[{
Cell[589, 20, 161, 3, 72, "Section",ExpressionUUID->"7c6636f2-ab23-4cc5-a29d-a1cc7d4fa932"],
Cell[753, 25, 198, 4, 44, "Input",ExpressionUUID->"01a0dcfc-d5bd-44f4-bafd-60b95e8c93bb"],
Cell[954, 31, 5012, 91, 393, "Input",ExpressionUUID->"38fa1908-f725-49be-9049-4be2f0f99151"],
Cell[5969, 124, 7216, 127, 538, "Input",ExpressionUUID->"51a329d7-018d-475a-b0d8-14b05c76edb8"],
Cell[13188, 253, 2365, 53, 335, "Input",ExpressionUUID->"75a21b9e-c4c3-42d3-8497-345038013da6"],
Cell[15556, 308, 181, 3, 44, "Input",ExpressionUUID->"7c59cd9d-9fb8-4037-ab0d-9551c036bd3b"],
Cell[15740, 313, 3993, 92, 509, "Input",ExpressionUUID->"ca2131d4-7636-4a65-85e0-383f921cff3f"],
Cell[19736, 407, 7016, 123, 393, "Input",ExpressionUUID->"2e5f329b-86f4-465d-91b4-b7acbb9a1cca"],
Cell[26755, 532, 221, 3, 44, "Input",ExpressionUUID->"0e1c0645-5ff4-4aec-87f9-7136300b9d66"],
Cell[26979, 537, 2866, 65, 393, "Input",ExpressionUUID->"dc13727f-e882-42b5-b703-c57d77486122"],
Cell[29848, 604, 7792, 174, 915, "Input",ExpressionUUID->"c376255f-227b-4417-987d-32e43e9998e8"],
Cell[37643, 780, 200, 2, 44, "Input",ExpressionUUID->"18bcc75b-9bd3-4eac-8f5e-94a18d9c7751"],
Cell[37846, 784, 9101, 193, 944, "Input",ExpressionUUID->"3ae69968-1ee5-4137-a1e2-6d4c788a3c49"],
Cell[46950, 979, 409, 8, 44, "Input",ExpressionUUID->"1908da5b-5783-44d3-bd2e-4e94eef4135a"],
Cell[47362, 989, 9419, 194, 944, "Input",ExpressionUUID->"533df61a-e2ea-493a-828e-bf37136201dc"],
Cell[56784, 1185, 8643, 180, 1466, "Input",ExpressionUUID->"aa395a04-cbe5-421b-946e-3b9705bc42aa"],
Cell[65430, 1367, 942, 25, 132, "Input",ExpressionUUID->"9c52f7a9-8d67-406a-9d3e-2744794f305d"],
Cell[66375, 1394, 1030, 27, 103, "Input",ExpressionUUID->"ff731b02-35af-40a9-b7e5-161f25709b46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67442, 1426, 210, 4, 93, "Section",ExpressionUUID->"8dd449b7-d98c-4362-a681-1e42cd06bccc"],
Cell[67655, 1432, 433, 7, 74, "Input",ExpressionUUID->"efacb65c-b55d-4d97-a744-43fbf6fa9e3d",
 InitializationCell->True],
Cell[68091, 1441, 225, 3, 44, "Input",ExpressionUUID->"60284711-1268-4276-8c3c-df68d9df88c6"],
Cell[68319, 1446, 11270, 279, 1582, "Input",ExpressionUUID->"a521d1de-257a-4e15-ad5d-4a474a03b1d0"],
Cell[79592, 1727, 204, 4, 44, "Input",ExpressionUUID->"af2a42e0-129e-41af-ba0d-f5c2f56e89db"],
Cell[79799, 1733, 2604, 54, 190, "Input",ExpressionUUID->"0267ab6d-8ecb-4718-85c2-db067d61922e"],
Cell[CellGroupData[{
Cell[82428, 1791, 925, 16, 44, "Input",ExpressionUUID->"0928a9be-db55-4a51-a345-39f20311c79a"],
Cell[83356, 1809, 1117, 19, 50, "Output",ExpressionUUID->"35b6428e-fb3b-483d-b2f4-abe86c4b5358"]
}, Open  ]],
Cell[84488, 1831, 597, 14, 74, "Input",ExpressionUUID->"6855031c-4680-4d24-a2a9-cd40b1ad729b"]
}, Open  ]]
}
]
*)

